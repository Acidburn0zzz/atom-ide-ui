'use strict';

var cov_1bky8jp6ty = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons/spec/stream-spec.js',
      hash = '60b9c3b160a4df6389792429fbef21cf453633af',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons/spec/stream-spec.js',
    statementMap: {
      '0': {
        start: {
          line: 18,
          column: 0
        },
        end: {
          line: 77,
          column: 3
        }
      },
      '1': {
        start: {
          line: 19,
          column: 2
        },
        end: {
          line: 33,
          column: 5
        }
      },
      '2': {
        start: {
          line: 20,
          column: 4
        },
        end: {
          line: 32,
          column: 7
        }
      },
      '3': {
        start: {
          line: 21,
          column: 20
        },
        end: {
          line: 21,
          column: 61
        }
      },
      '4': {
        start: {
          line: 22,
          column: 21
        },
        end: {
          line: 22,
          column: 45
        }
      },
      '5': {
        start: {
          line: 23,
          column: 22
        },
        end: {
          line: 25,
          column: 20
        }
      },
      '6': {
        start: {
          line: 26,
          column: 6
        },
        end: {
          line: 28,
          column: 9
        }
      },
      '7': {
        start: {
          line: 27,
          column: 8
        },
        end: {
          line: 27,
          column: 36
        }
      },
      '8': {
        start: {
          line: 29,
          column: 6
        },
        end: {
          line: 29,
          column: 19
        }
      },
      '9': {
        start: {
          line: 30,
          column: 21
        },
        end: {
          line: 30,
          column: 34
        }
      },
      '10': {
        start: {
          line: 31,
          column: 6
        },
        end: {
          line: 31,
          column: 54
        }
      },
      '11': {
        start: {
          line: 35,
          column: 2
        },
        end: {
          line: 58,
          column: 5
        }
      },
      '12': {
        start: {
          line: 36,
          column: 4
        },
        end: {
          line: 57,
          column: 7
        }
      },
      '13': {
        start: {
          line: 37,
          column: 21
        },
        end: {
          line: 37,
          column: 45
        }
      },
      '14': {
        start: {
          line: 38,
          column: 20
        },
        end: {
          line: 38,
          column: 61
        }
      },
      '15': {
        start: {
          line: 39,
          column: 21
        },
        end: {
          line: 39,
          column: 23
        }
      },
      '16': {
        start: {
          line: 40,
          column: 22
        },
        end: {
          line: 46,
          column: 8
        }
      },
      '17': {
        start: {
          line: 41,
          column: 8
        },
        end: {
          line: 45,
          column: 10
        }
      },
      '18': {
        start: {
          line: 42,
          column: 15
        },
        end: {
          line: 42,
          column: 29
        }
      },
      '19': {
        start: {
          line: 43,
          column: 15
        },
        end: {
          line: 43,
          column: 25
        }
      },
      '20': {
        start: {
          line: 47,
          column: 20
        },
        end: {
          line: 47,
          column: 45
        }
      },
      '21': {
        start: {
          line: 49,
          column: 6
        },
        end: {
          line: 51,
          column: 9
        }
      },
      '22': {
        start: {
          line: 50,
          column: 8
        },
        end: {
          line: 50,
          column: 36
        }
      },
      '23': {
        start: {
          line: 52,
          column: 6
        },
        end: {
          line: 52,
          column: 34
        }
      },
      '24': {
        start: {
          line: 54,
          column: 21
        },
        end: {
          line: 54,
          column: 34
        }
      },
      '25': {
        start: {
          line: 55,
          column: 6
        },
        end: {
          line: 55,
          column: 36
        }
      },
      '26': {
        start: {
          line: 56,
          column: 6
        },
        end: {
          line: 56,
          column: 33
        }
      },
      '27': {
        start: {
          line: 60,
          column: 2
        },
        end: {
          line: 76,
          column: 5
        }
      },
      '28': {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 75,
          column: 7
        }
      },
      '29': {
        start: {
          line: 62,
          column: 23
        },
        end: {
          line: 62,
          column: 49
        }
      },
      '30': {
        start: {
          line: 63,
          column: 26
        },
        end: {
          line: 63,
          column: 48
        }
      },
      '31': {
        start: {
          line: 64,
          column: 21
        },
        end: {
          line: 64,
          column: 72
        }
      },
      '32': {
        start: {
          line: 66,
          column: 25
        },
        end: {
          line: 68,
          column: 7
        }
      },
      '33': {
        start: {
          line: 70,
          column: 6
        },
        end: {
          line: 70,
          column: 58
        }
      },
      '34': {
        start: {
          line: 72,
          column: 26
        },
        end: {
          line: 72,
          column: 60
        }
      },
      '35': {
        start: {
          line: 73,
          column: 26
        },
        end: {
          line: 73,
          column: 63
        }
      },
      '36': {
        start: {
          line: 74,
          column: 6
        },
        end: {
          line: 74,
          column: 47
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 18,
            column: 32
          },
          end: {
            line: 18,
            column: 33
          }
        },
        loc: {
          start: {
            line: 18,
            column: 38
          },
          end: {
            line: 77,
            column: 1
          }
        },
        line: 18
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 19,
            column: 22
          },
          end: {
            line: 19,
            column: 23
          }
        },
        loc: {
          start: {
            line: 19,
            column: 28
          },
          end: {
            line: 33,
            column: 3
          }
        },
        line: 19
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 20,
            column: 20
          },
          end: {
            line: 20,
            column: 21
          }
        },
        loc: {
          start: {
            line: 20,
            column: 32
          },
          end: {
            line: 32,
            column: 5
          }
        },
        line: 20
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 26,
            column: 20
          },
          end: {
            line: 26,
            column: 21
          }
        },
        loc: {
          start: {
            line: 26,
            column: 29
          },
          end: {
            line: 28,
            column: 7
          }
        },
        line: 26
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 35,
            column: 30
          },
          end: {
            line: 35,
            column: 31
          }
        },
        loc: {
          start: {
            line: 35,
            column: 36
          },
          end: {
            line: 58,
            column: 3
          }
        },
        line: 35
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 36,
            column: 20
          },
          end: {
            line: 36,
            column: 21
          }
        },
        loc: {
          start: {
            line: 36,
            column: 32
          },
          end: {
            line: 57,
            column: 5
          }
        },
        line: 36
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 40,
            column: 34
          },
          end: {
            line: 40,
            column: 35
          }
        },
        loc: {
          start: {
            line: 40,
            column: 55
          },
          end: {
            line: 46,
            column: 7
          }
        },
        line: 40
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 42,
            column: 10
          },
          end: {
            line: 42,
            column: 11
          }
        },
        loc: {
          start: {
            line: 42,
            column: 15
          },
          end: {
            line: 42,
            column: 29
          }
        },
        line: 42
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 43,
            column: 10
          },
          end: {
            line: 43,
            column: 11
          }
        },
        loc: {
          start: {
            line: 43,
            column: 15
          },
          end: {
            line: 43,
            column: 25
          }
        },
        line: 43
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 44,
            column: 10
          },
          end: {
            line: 44,
            column: 11
          }
        },
        loc: {
          start: {
            line: 44,
            column: 16
          },
          end: {
            line: 44,
            column: 18
          }
        },
        line: 44
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 49,
            column: 20
          },
          end: {
            line: 49,
            column: 21
          }
        },
        loc: {
          start: {
            line: 49,
            column: 29
          },
          end: {
            line: 51,
            column: 7
          }
        },
        line: 49
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 60,
            column: 22
          },
          end: {
            line: 60,
            column: 23
          }
        },
        loc: {
          start: {
            line: 60,
            column: 28
          },
          end: {
            line: 76,
            column: 3
          }
        },
        line: 60
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 61,
            column: 20
          },
          end: {
            line: 61,
            column: 21
          }
        },
        loc: {
          start: {
            line: 61,
            column: 32
          },
          end: {
            line: 75,
            column: 5
          }
        },
        line: 61
      }
    },
    branchMap: {},
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0
    },
    b: {},
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _asyncToGenerator = _interopRequireDefault(require('async-to-generator'));

var _stream;

function _load_stream() {
  return _stream = require('../stream');
}

var _fsPromise;

function _load_fsPromise() {
  return _fsPromise = _interopRequireDefault(require('../fsPromise'));
}

var _stream2 = _interopRequireDefault(require('stream'));

var _fs = _interopRequireDefault(require('fs'));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

cov_1bky8jp6ty.s[0]++;


describe('commons-node/stream', () => {
  cov_1bky8jp6ty.f[0]++;
  cov_1bky8jp6ty.s[1]++;

  it('observeStream', () => {
    cov_1bky8jp6ty.f[1]++;
    cov_1bky8jp6ty.s[2]++;

    waitsForPromise((0, _asyncToGenerator.default)(function* () {
      cov_1bky8jp6ty.f[2]++;

      const input = (cov_1bky8jp6ty.s[3]++, ['foo\nbar', '\n', '\nba', 'z', '\nblar']);
      const stream = (cov_1bky8jp6ty.s[4]++, new _stream2.default.PassThrough());
      const promise = (cov_1bky8jp6ty.s[5]++, (0, (_stream || _load_stream()).observeStream)(stream).toArray().toPromise());
      cov_1bky8jp6ty.s[6]++;
      input.forEach(function (value) {
        cov_1bky8jp6ty.f[3]++;
        cov_1bky8jp6ty.s[7]++;

        stream.write(value, 'utf8');
      });
      cov_1bky8jp6ty.s[8]++;
      stream.end();
      const output = (cov_1bky8jp6ty.s[9]++, yield promise);
      cov_1bky8jp6ty.s[10]++;
      expect(output.join('')).toEqual(input.join(''));
    }));
  });

  cov_1bky8jp6ty.s[11]++;
  it('observeStream - error', () => {
    cov_1bky8jp6ty.f[4]++;
    cov_1bky8jp6ty.s[12]++;

    waitsForPromise((0, _asyncToGenerator.default)(function* () {
      cov_1bky8jp6ty.f[5]++;

      const stream = (cov_1bky8jp6ty.s[13]++, new _stream2.default.PassThrough());
      const input = (cov_1bky8jp6ty.s[14]++, ['foo\nbar', '\n', '\nba', 'z', '\nblar']);
      const output = (cov_1bky8jp6ty.s[15]++, []);
      const promise = (cov_1bky8jp6ty.s[16]++, new Promise(function (resolve, reject) {
        cov_1bky8jp6ty.f[6]++;
        cov_1bky8jp6ty.s[17]++;

        (0, (_stream || _load_stream()).observeStream)(stream).subscribe(function (v) {
          cov_1bky8jp6ty.f[7]++;
          cov_1bky8jp6ty.s[18]++;
          return output.push(v);
        }, function (e) {
          cov_1bky8jp6ty.f[8]++;
          cov_1bky8jp6ty.s[19]++;
          return resolve(e);
        }, function () {
          cov_1bky8jp6ty.f[9]++;
        });
      }));
      const error = (cov_1bky8jp6ty.s[20]++, new Error('Had an error'));

      cov_1bky8jp6ty.s[21]++;
      input.forEach(function (value) {
        cov_1bky8jp6ty.f[10]++;
        cov_1bky8jp6ty.s[22]++;

        stream.write(value, 'utf8');
      });
      cov_1bky8jp6ty.s[23]++;
      stream.emit('error', error);

      const result = (cov_1bky8jp6ty.s[24]++, yield promise);
      cov_1bky8jp6ty.s[25]++;
      expect(output).toEqual(input);
      cov_1bky8jp6ty.s[26]++;
      expect(result).toBe(error);
    }));
  });

  cov_1bky8jp6ty.s[27]++;
  it('writeToStream', () => {
    cov_1bky8jp6ty.f[11]++;
    cov_1bky8jp6ty.s[28]++;

    waitsForPromise((0, _asyncToGenerator.default)(function* () {
      cov_1bky8jp6ty.f[12]++;

      const tempPath = (cov_1bky8jp6ty.s[29]++, yield (_fsPromise || _load_fsPromise()).default.tempfile());
      const fixturePath = (cov_1bky8jp6ty.s[30]++, 'spec/fixtures/lyrics');
      const stream = (cov_1bky8jp6ty.s[31]++, _fs.default.createWriteStream(tempPath, { highWaterMark: 10 }));
      // Read faster than we write to test buffering
      const observable = (cov_1bky8jp6ty.s[32]++, (0, (_stream || _load_stream()).observeRawStream)(_fs.default.createReadStream(fixturePath, { highWaterMark: 100 })));

      cov_1bky8jp6ty.s[33]++;
      yield (0, (_stream || _load_stream()).writeToStream)(observable, stream).toPromise();

      const writtenFile = (cov_1bky8jp6ty.s[34]++, yield (_fsPromise || _load_fsPromise()).default.readFile(tempPath));
      const fixtureFile = (cov_1bky8jp6ty.s[35]++, yield (_fsPromise || _load_fsPromise()).default.readFile(fixturePath));
      cov_1bky8jp6ty.s[36]++;
      expect(writtenFile).toEqual(fixtureFile);
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0cmVhbS1zcGVjLmpzIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwiaXQiLCJ3YWl0c0ZvclByb21pc2UiLCJpbnB1dCIsInN0cmVhbSIsIlBhc3NUaHJvdWdoIiwicHJvbWlzZSIsInRvQXJyYXkiLCJ0b1Byb21pc2UiLCJmb3JFYWNoIiwid3JpdGUiLCJ2YWx1ZSIsImVuZCIsIm91dHB1dCIsImV4cGVjdCIsImpvaW4iLCJ0b0VxdWFsIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzdWJzY3JpYmUiLCJwdXNoIiwidiIsImUiLCJlcnJvciIsIkVycm9yIiwiZW1pdCIsInJlc3VsdCIsInRvQmUiLCJ0ZW1wUGF0aCIsInRlbXBmaWxlIiwiZml4dHVyZVBhdGgiLCJjcmVhdGVXcml0ZVN0cmVhbSIsImhpZ2hXYXRlck1hcmsiLCJvYnNlcnZhYmxlIiwiY3JlYXRlUmVhZFN0cmVhbSIsIndyaXR0ZW5GaWxlIiwicmVhZEZpbGUiLCJmaXh0dXJlRmlsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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akJvQztBQTBDcEN2QixLQUFHLGVBQUgsRUFBb0IsTUFBTTtBQUFBO0FBQUE7O0FBQ3hCQyxtREFBZ0IsYUFBWTtBQUFBOztBQUMxQixZQUFNMkIsb0NBQVcsTUFBTSwwQ0FBVUMsUUFBVixFQUFqQixDQUFOO0FBQ0EsWUFBTUMsdUNBQWMsc0JBQWQsQ0FBTjtBQUNBLFlBQU0zQixrQ0FBUyxZQUFHNEIsaUJBQUgsQ0FBcUJILFFBQXJCLEVBQStCLEVBQUNJLGVBQWUsRUFBaEIsRUFBL0IsQ0FBVCxDQUFOO0FBQ0E7QUFDQSxZQUFNQyxzQ0FBYSxrREFDakIsWUFBR0MsZ0JBQUgsQ0FBb0JKLFdBQXBCLEVBQWlDLEVBQUNFLGVBQWUsR0FBaEIsRUFBakMsQ0FEaUIsQ0FBYixDQUFOOztBQUwwQjtBQVMxQixZQUFNLCtDQUFjQyxVQUFkLEVBQTBCOUIsTUFBMUIsRUFBa0NJLFNBQWxDLEVBQU47O0FBRUEsWUFBTTRCLHVDQUFjLE1BQU0sMENBQVVDLFFBQVYsQ0FBbUJSLFFBQW5CLENBQXBCLENBQU47QUFDQSxZQUFNUyx1Q0FBYyxNQUFNLDBDQUFVRCxRQUFWLENBQW1CTixXQUFuQixDQUFwQixDQUFOO0FBWjBCO0FBYTFCakIsYUFBT3NCLFdBQVAsRUFBb0JwQixPQUFwQixDQUE0QnNCLFdBQTVCO0FBQ0QsS0FkRDtBQWVELEdBaEJEO0FBaUJELENBM0REIiwiZmlsZSI6InN0cmVhbS1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHtvYnNlcnZlU3RyZWFtLCBvYnNlcnZlUmF3U3RyZWFtLCB3cml0ZVRvU3RyZWFtfSBmcm9tICcuLi9zdHJlYW0nO1xuaW1wb3J0IGZzUHJvbWlzZSBmcm9tICcuLi9mc1Byb21pc2UnO1xuaW1wb3J0IFN0cmVhbSBmcm9tICdzdHJlYW0nO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcblxuZGVzY3JpYmUoJ2NvbW1vbnMtbm9kZS9zdHJlYW0nLCAoKSA9PiB7XG4gIGl0KCdvYnNlcnZlU3RyZWFtJywgKCkgPT4ge1xuICAgIHdhaXRzRm9yUHJvbWlzZShhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnB1dCA9IFsnZm9vXFxuYmFyJywgJ1xcbicsICdcXG5iYScsICd6JywgJ1xcbmJsYXInXTtcbiAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBTdHJlYW0uUGFzc1Rocm91Z2goKTtcbiAgICAgIGNvbnN0IHByb21pc2UgPSBvYnNlcnZlU3RyZWFtKHN0cmVhbSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAudG9Qcm9taXNlKCk7XG4gICAgICBpbnB1dC5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICAgICAgc3RyZWFtLndyaXRlKHZhbHVlLCAndXRmOCcpO1xuICAgICAgfSk7XG4gICAgICBzdHJlYW0uZW5kKCk7XG4gICAgICBjb25zdCBvdXRwdXQgPSBhd2FpdCBwcm9taXNlO1xuICAgICAgZXhwZWN0KG91dHB1dC5qb2luKCcnKSkudG9FcXVhbChpbnB1dC5qb2luKCcnKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdvYnNlcnZlU3RyZWFtIC0gZXJyb3InLCAoKSA9PiB7XG4gICAgd2FpdHNGb3JQcm9taXNlKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBTdHJlYW0uUGFzc1Rocm91Z2goKTtcbiAgICAgIGNvbnN0IGlucHV0ID0gWydmb29cXG5iYXInLCAnXFxuJywgJ1xcbmJhJywgJ3onLCAnXFxuYmxhciddO1xuICAgICAgY29uc3Qgb3V0cHV0ID0gW107XG4gICAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBvYnNlcnZlU3RyZWFtKHN0cmVhbSkuc3Vic2NyaWJlKFxuICAgICAgICAgIHYgPT4gb3V0cHV0LnB1c2godiksXG4gICAgICAgICAgZSA9PiByZXNvbHZlKGUpLFxuICAgICAgICAgICgpID0+IHt9LFxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignSGFkIGFuIGVycm9yJyk7XG5cbiAgICAgIGlucHV0LmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgICBzdHJlYW0ud3JpdGUodmFsdWUsICd1dGY4Jyk7XG4gICAgICB9KTtcbiAgICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGVycm9yKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvbWlzZTtcbiAgICAgIGV4cGVjdChvdXRwdXQpLnRvRXF1YWwoaW5wdXQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShlcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCd3cml0ZVRvU3RyZWFtJywgKCkgPT4ge1xuICAgIHdhaXRzRm9yUHJvbWlzZShhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZW1wUGF0aCA9IGF3YWl0IGZzUHJvbWlzZS50ZW1wZmlsZSgpO1xuICAgICAgY29uc3QgZml4dHVyZVBhdGggPSAnc3BlYy9maXh0dXJlcy9seXJpY3MnO1xuICAgICAgY29uc3Qgc3RyZWFtID0gZnMuY3JlYXRlV3JpdGVTdHJlYW0odGVtcFBhdGgsIHtoaWdoV2F0ZXJNYXJrOiAxMH0pO1xuICAgICAgLy8gUmVhZCBmYXN0ZXIgdGhhbiB3ZSB3cml0ZSB0byB0ZXN0IGJ1ZmZlcmluZ1xuICAgICAgY29uc3Qgb2JzZXJ2YWJsZSA9IG9ic2VydmVSYXdTdHJlYW0oXG4gICAgICAgIGZzLmNyZWF0ZVJlYWRTdHJlYW0oZml4dHVyZVBhdGgsIHtoaWdoV2F0ZXJNYXJrOiAxMDB9KSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdyaXRlVG9TdHJlYW0ob2JzZXJ2YWJsZSwgc3RyZWFtKS50b1Byb21pc2UoKTtcblxuICAgICAgY29uc3Qgd3JpdHRlbkZpbGUgPSBhd2FpdCBmc1Byb21pc2UucmVhZEZpbGUodGVtcFBhdGgpO1xuICAgICAgY29uc3QgZml4dHVyZUZpbGUgPSBhd2FpdCBmc1Byb21pc2UucmVhZEZpbGUoZml4dHVyZVBhdGgpO1xuICAgICAgZXhwZWN0KHdyaXR0ZW5GaWxlKS50b0VxdWFsKGZpeHR1cmVGaWxlKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==