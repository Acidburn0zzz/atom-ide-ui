'use strict';

var cov_2mhq4ffnwk = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-diagnostics/spec/MessageRangeTracker-spec.js',
      hash = '0595572c256945eca3506f1e8e188e5a817a6830',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-diagnostics/spec/MessageRangeTracker-spec.js',
    statementMap: {
      '0': {
        start: {
          line: 22,
          column: 0
        },
        end: {
          line: 210,
          column: 3
        }
      },
      '1': {
        start: {
          line: 23,
          column: 38
        },
        end: {
          line: 23,
          column: 47
        }
      },
      '2': {
        start: {
          line: 25,
          column: 39
        },
        end: {
          line: 25,
          column: 48
        }
      },
      '3': {
        start: {
          line: 26,
          column: 41
        },
        end: {
          line: 26,
          column: 50
        }
      },
      '4': {
        start: {
          line: 28,
          column: 60
        },
        end: {
          line: 28,
          column: 69
        }
      },
      '5': {
        start: {
          line: 29,
          column: 62
        },
        end: {
          line: 29,
          column: 71
        }
      },
      '6': {
        start: {
          line: 31,
          column: 46
        },
        end: {
          line: 31,
          column: 55
        }
      },
      '7': {
        start: {
          line: 33,
          column: 2
        },
        end: {
          line: 77,
          column: 5
        }
      },
      '8': {
        start: {
          line: 34,
          column: 4
        },
        end: {
          line: 34,
          column: 40
        }
      },
      '9': {
        start: {
          line: 36,
          column: 25
        },
        end: {
          line: 36,
          column: 63
        }
      },
      '10': {
        start: {
          line: 37,
          column: 4
        },
        end: {
          line: 40,
          column: 6
        }
      },
      '11': {
        start: {
          line: 41,
          column: 4
        },
        end: {
          line: 44,
          column: 6
        }
      },
      '12': {
        start: {
          line: 46,
          column: 4
        },
        end: {
          line: 58,
          column: 6
        }
      },
      '13': {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 72,
          column: 6
        }
      },
      '14': {
        start: {
          line: 74,
          column: 4
        },
        end: {
          line: 76,
          column: 7
        }
      },
      '15': {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 75,
          column: 77
        }
      },
      '16': {
        start: {
          line: 79,
          column: 2
        },
        end: {
          line: 83,
          column: 5
        }
      },
      '17': {
        start: {
          line: 80,
          column: 4
        },
        end: {
          line: 82,
          column: 5
        }
      },
      '18': {
        start: {
          line: 81,
          column: 6
        },
        end: {
          line: 81,
          column: 23
        }
      },
      '19': {
        start: {
          line: 85,
          column: 2
        },
        end: {
          line: 91,
          column: 5
        }
      },
      '20': {
        start: {
          line: 86,
          column: 4
        },
        end: {
          line: 86,
          column: 59
        }
      },
      '21': {
        start: {
          line: 87,
          column: 18
        },
        end: {
          line: 87,
          column: 70
        }
      },
      '22': {
        start: {
          line: 88,
          column: 4
        },
        end: {
          line: 88,
          column: 29
        }
      },
      '23': {
        start: {
          line: 89,
          column: 4
        },
        end: {
          line: 89,
          column: 68
        }
      },
      '24': {
        start: {
          line: 90,
          column: 4
        },
        end: {
          line: 90,
          column: 22
        }
      },
      '25': {
        start: {
          line: 93,
          column: 2
        },
        end: {
          line: 103,
          column: 5
        }
      },
      '26': {
        start: {
          line: 94,
          column: 4
        },
        end: {
          line: 94,
          column: 59
        }
      },
      '27': {
        start: {
          line: 95,
          column: 4
        },
        end: {
          line: 98,
          column: 6
        }
      },
      '28': {
        start: {
          line: 99,
          column: 18
        },
        end: {
          line: 99,
          column: 70
        }
      },
      '29': {
        start: {
          line: 100,
          column: 4
        },
        end: {
          line: 100,
          column: 29
        }
      },
      '30': {
        start: {
          line: 101,
          column: 4
        },
        end: {
          line: 101,
          column: 68
        }
      },
      '31': {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 102,
          column: 22
        }
      },
      '32': {
        start: {
          line: 105,
          column: 2
        },
        end: {
          line: 111,
          column: 5
        }
      },
      '33': {
        start: {
          line: 106,
          column: 4
        },
        end: {
          line: 106,
          column: 59
        }
      },
      '34': {
        start: {
          line: 107,
          column: 4
        },
        end: {
          line: 107,
          column: 78
        }
      },
      '35': {
        start: {
          line: 108,
          column: 18
        },
        end: {
          line: 108,
          column: 70
        }
      },
      '36': {
        start: {
          line: 109,
          column: 4
        },
        end: {
          line: 109,
          column: 29
        }
      },
      '37': {
        start: {
          line: 110,
          column: 4
        },
        end: {
          line: 110,
          column: 22
        }
      },
      '38': {
        start: {
          line: 113,
          column: 2
        },
        end: {
          line: 135,
          column: 5
        }
      },
      '39': {
        start: {
          line: 114,
          column: 4
        },
        end: {
          line: 134,
          column: 7
        }
      },
      '40': {
        start: {
          line: 115,
          column: 6
        },
        end: {
          line: 115,
          column: 63
        }
      },
      '41': {
        start: {
          line: 116,
          column: 6
        },
        end: {
          line: 116,
          column: 24
        }
      },
      '42': {
        start: {
          line: 117,
          column: 6
        },
        end: {
          line: 117,
          column: 80
        }
      },
      '43': {
        start: {
          line: 118,
          column: 36
        },
        end: {
          line: 120,
          column: 7
        }
      },
      '44': {
        start: {
          line: 121,
          column: 18
        },
        end: {
          line: 121,
          column: 72
        }
      },
      '45': {
        start: {
          line: 122,
          column: 6
        },
        end: {
          line: 122,
          column: 31
        }
      },
      '46': {
        start: {
          line: 123,
          column: 6
        },
        end: {
          line: 123,
          column: 69
        }
      },
      '47': {
        start: {
          line: 125,
          column: 6
        },
        end: {
          line: 128,
          column: 8
        }
      },
      '48': {
        start: {
          line: 130,
          column: 6
        },
        end: {
          line: 130,
          column: 69
        }
      },
      '49': {
        start: {
          line: 131,
          column: 6
        },
        end: {
          line: 131,
          column: 31
        }
      },
      '50': {
        start: {
          line: 132,
          column: 6
        },
        end: {
          line: 132,
          column: 69
        }
      },
      '51': {
        start: {
          line: 133,
          column: 6
        },
        end: {
          line: 133,
          column: 24
        }
      },
      '52': {
        start: {
          line: 140,
          column: 2
        },
        end: {
          line: 158,
          column: 5
        }
      },
      '53': {
        start: {
          line: 141,
          column: 4
        },
        end: {
          line: 141,
          column: 59
        }
      },
      '54': {
        start: {
          line: 142,
          column: 23
        },
        end: {
          line: 142,
          column: 73
        }
      },
      '55': {
        start: {
          line: 143,
          column: 4
        },
        end: {
          line: 143,
          column: 34
        }
      },
      '56': {
        start: {
          line: 144,
          column: 4
        },
        end: {
          line: 144,
          column: 69
        }
      },
      '57': {
        start: {
          line: 145,
          column: 19
        },
        end: {
          line: 145,
          column: 76
        }
      },
      '58': {
        start: {
          line: 146,
          column: 4
        },
        end: {
          line: 146,
          column: 30
        }
      },
      '59': {
        start: {
          line: 148,
          column: 4
        },
        end: {
          line: 148,
          column: 22
        }
      },
      '60': {
        start: {
          line: 150,
          column: 4
        },
        end: {
          line: 150,
          column: 62
        }
      },
      '61': {
        start: {
          line: 151,
          column: 4
        },
        end: {
          line: 151,
          column: 78
        }
      },
      '62': {
        start: {
          line: 152,
          column: 4
        },
        end: {
          line: 154,
          column: 18
        }
      },
      '63': {
        start: {
          line: 155,
          column: 4
        },
        end: {
          line: 155,
          column: 46
        }
      },
      '64': {
        start: {
          line: 157,
          column: 4
        },
        end: {
          line: 157,
          column: 22
        }
      },
      '65': {
        start: {
          line: 160,
          column: 2
        },
        end: {
          line: 173,
          column: 5
        }
      },
      '66': {
        start: {
          line: 161,
          column: 4
        },
        end: {
          line: 161,
          column: 61
        }
      },
      '67': {
        start: {
          line: 162,
          column: 4
        },
        end: {
          line: 164,
          column: 18
        }
      },
      '68': {
        start: {
          line: 165,
          column: 24
        },
        end: {
          line: 165,
          column: 76
        }
      },
      '69': {
        start: {
          line: 166,
          column: 4
        },
        end: {
          line: 166,
          column: 35
        }
      },
      '70': {
        start: {
          line: 167,
          column: 4
        },
        end: {
          line: 167,
          column: 72
        }
      },
      '71': {
        start: {
          line: 169,
          column: 4
        },
        end: {
          line: 169,
          column: 64
        }
      },
      '72': {
        start: {
          line: 170,
          column: 4
        },
        end: {
          line: 170,
          column: 80
        }
      },
      '73': {
        start: {
          line: 172,
          column: 4
        },
        end: {
          line: 172,
          column: 22
        }
      },
      '74': {
        start: {
          line: 175,
          column: 2
        },
        end: {
          line: 194,
          column: 5
        }
      },
      '75': {
        start: {
          line: 176,
          column: 4
        },
        end: {
          line: 176,
          column: 59
        }
      },
      '76': {
        start: {
          line: 177,
          column: 19
        },
        end: {
          line: 177,
          column: 76
        }
      },
      '77': {
        start: {
          line: 178,
          column: 4
        },
        end: {
          line: 178,
          column: 30
        }
      },
      '78': {
        start: {
          line: 180,
          column: 4
        },
        end: {
          line: 180,
          column: 34
        }
      },
      '79': {
        start: {
          line: 182,
          column: 23
        },
        end: {
          line: 182,
          column: 73
        }
      },
      '80': {
        start: {
          line: 183,
          column: 4
        },
        end: {
          line: 183,
          column: 34
        }
      },
      '81': {
        start: {
          line: 185,
          column: 4
        },
        end: {
          line: 185,
          column: 69
        }
      },
      '82': {
        start: {
          line: 187,
          column: 4
        },
        end: {
          line: 189,
          column: 18
        }
      },
      '83': {
        start: {
          line: 191,
          column: 4
        },
        end: {
          line: 191,
          column: 46
        }
      },
      '84': {
        start: {
          line: 193,
          column: 4
        },
        end: {
          line: 193,
          column: 22
        }
      },
      '85': {
        start: {
          line: 196,
          column: 2
        },
        end: {
          line: 209,
          column: 5
        }
      },
      '86': {
        start: {
          line: 197,
          column: 4
        },
        end: {
          line: 197,
          column: 59
        }
      },
      '87': {
        start: {
          line: 198,
          column: 19
        },
        end: {
          line: 198,
          column: 76
        }
      },
      '88': {
        start: {
          line: 199,
          column: 4
        },
        end: {
          line: 199,
          column: 30
        }
      },
      '89': {
        start: {
          line: 201,
          column: 4
        },
        end: {
          line: 201,
          column: 45
        }
      },
      '90': {
        start: {
          line: 202,
          column: 4
        },
        end: {
          line: 202,
          column: 22
        }
      },
      '91': {
        start: {
          line: 203,
          column: 4
        },
        end: {
          line: 203,
          column: 46
        }
      },
      '92': {
        start: {
          line: 205,
          column: 4
        },
        end: {
          line: 205,
          column: 49
        }
      },
      '93': {
        start: {
          line: 206,
          column: 4
        },
        end: {
          line: 206,
          column: 50
        }
      },
      '94': {
        start: {
          line: 208,
          column: 4
        },
        end: {
          line: 208,
          column: 22
        }
      },
      '95': {
        start: {
          line: 217,
          column: 20
        },
        end: {
          line: 219,
          column: 3
        }
      },
      '96': {
        start: {
          line: 218,
          column: 50
        },
        end: {
          line: 218,
          column: 66
        }
      },
      '97': {
        start: {
          line: 221,
          column: 2
        },
        end: {
          line: 223,
          column: 3
        }
      },
      '98': {
        start: {
          line: 222,
          column: 4
        },
        end: {
          line: 222,
          column: 57
        }
      },
      '99': {
        start: {
          line: 225,
          column: 2
        },
        end: {
          line: 227,
          column: 3
        }
      },
      '100': {
        start: {
          line: 226,
          column: 4
        },
        end: {
          line: 226,
          column: 45
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 22,
            column: 32
          },
          end: {
            line: 22,
            column: 33
          }
        },
        loc: {
          start: {
            line: 22,
            column: 38
          },
          end: {
            line: 210,
            column: 1
          }
        },
        line: 22
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 33,
            column: 13
          },
          end: {
            line: 33,
            column: 14
          }
        },
        loc: {
          start: {
            line: 33,
            column: 19
          },
          end: {
            line: 77,
            column: 3
          }
        },
        line: 33
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 74,
            column: 20
          },
          end: {
            line: 74,
            column: 21
          }
        },
        loc: {
          start: {
            line: 74,
            column: 32
          },
          end: {
            line: 76,
            column: 5
          }
        },
        line: 74
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 79,
            column: 12
          },
          end: {
            line: 79,
            column: 13
          }
        },
        loc: {
          start: {
            line: 79,
            column: 18
          },
          end: {
            line: 83,
            column: 3
          }
        },
        line: 79
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 85,
            column: 52
          },
          end: {
            line: 85,
            column: 53
          }
        },
        loc: {
          start: {
            line: 85,
            column: 58
          },
          end: {
            line: 91,
            column: 3
          }
        },
        line: 85
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 93,
            column: 53
          },
          end: {
            line: 93,
            column: 54
          }
        },
        loc: {
          start: {
            line: 93,
            column: 59
          },
          end: {
            line: 103,
            column: 3
          }
        },
        line: 93
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 105,
            column: 68
          },
          end: {
            line: 105,
            column: 69
          }
        },
        loc: {
          start: {
            line: 105,
            column: 74
          },
          end: {
            line: 111,
            column: 3
          }
        },
        line: 105
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 113,
            column: 57
          },
          end: {
            line: 113,
            column: 58
          }
        },
        loc: {
          start: {
            line: 113,
            column: 63
          },
          end: {
            line: 135,
            column: 3
          }
        },
        line: 113
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 114,
            column: 20
          },
          end: {
            line: 114,
            column: 21
          }
        },
        loc: {
          start: {
            line: 114,
            column: 32
          },
          end: {
            line: 134,
            column: 5
          }
        },
        line: 114
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 140,
            column: 66
          },
          end: {
            line: 140,
            column: 67
          }
        },
        loc: {
          start: {
            line: 140,
            column: 72
          },
          end: {
            line: 158,
            column: 3
          }
        },
        line: 140
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 160,
            column: 48
          },
          end: {
            line: 160,
            column: 49
          }
        },
        loc: {
          start: {
            line: 160,
            column: 54
          },
          end: {
            line: 173,
            column: 3
          }
        },
        line: 160
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 175,
            column: 62
          },
          end: {
            line: 175,
            column: 63
          }
        },
        loc: {
          start: {
            line: 175,
            column: 68
          },
          end: {
            line: 194,
            column: 3
          }
        },
        line: 175
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 196,
            column: 38
          },
          end: {
            line: 196,
            column: 39
          }
        },
        loc: {
          start: {
            line: 196,
            column: 44
          },
          end: {
            line: 209,
            column: 3
          }
        },
        line: 196
      },
      '13': {
        name: 'checkRep',
        decl: {
          start: {
            line: 216,
            column: 9
          },
          end: {
            line: 216,
            column: 17
          }
        },
        loc: {
          start: {
            line: 216,
            column: 54
          },
          end: {
            line: 228,
            column: 1
          }
        },
        line: 216
      },
      '14': {
        name: '(anonymous_14)',
        decl: {
          start: {
            line: 218,
            column: 40
          },
          end: {
            line: 218,
            column: 41
          }
        },
        loc: {
          start: {
            line: 218,
            column: 50
          },
          end: {
            line: 218,
            column: 66
          }
        },
        line: 218
      }
    },
    branchMap: {},
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0,
      '47': 0,
      '48': 0,
      '49': 0,
      '50': 0,
      '51': 0,
      '52': 0,
      '53': 0,
      '54': 0,
      '55': 0,
      '56': 0,
      '57': 0,
      '58': 0,
      '59': 0,
      '60': 0,
      '61': 0,
      '62': 0,
      '63': 0,
      '64': 0,
      '65': 0,
      '66': 0,
      '67': 0,
      '68': 0,
      '69': 0,
      '70': 0,
      '71': 0,
      '72': 0,
      '73': 0,
      '74': 0,
      '75': 0,
      '76': 0,
      '77': 0,
      '78': 0,
      '79': 0,
      '80': 0,
      '81': 0,
      '82': 0,
      '83': 0,
      '84': 0,
      '85': 0,
      '86': 0,
      '87': 0,
      '88': 0,
      '89': 0,
      '90': 0,
      '91': 0,
      '92': 0,
      '93': 0,
      '94': 0,
      '95': 0,
      '96': 0,
      '97': 0,
      '98': 0,
      '99': 0,
      '100': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0
    },
    b: {},
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _asyncToGenerator = _interopRequireDefault(require('async-to-generator'));

var _atom = require('atom');

var _MessageRangeTracker;

function _load_MessageRangeTracker() {
  return _MessageRangeTracker = _interopRequireDefault(require('../lib/MessageRangeTracker'));
}

var _nuclideUri;

function _load_nuclideUri() {
  return _nuclideUri = _interopRequireDefault(require('nuclide-commons/nuclideUri'));
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

cov_2mhq4ffnwk.s[0]++; /**
                        * Copyright (c) 2017-present, Facebook, Inc.
                        * All rights reserved.
                        *
                        * This source code is licensed under the BSD-style license found in the
                        * LICENSE file in the root directory of this source tree. An additional grant
                        * of patent rights can be found in the PATENTS file in the same directory.
                        *
                        * 
                        * @format
                        */

describe('MessageRangeTracker', () => {
  cov_2mhq4ffnwk.f[0]++;

  let tracker = (cov_2mhq4ffnwk.s[1]++, null);

  let initiallyOpenFilePath = (cov_2mhq4ffnwk.s[2]++, null);
  let initiallyClosedFilePath = (cov_2mhq4ffnwk.s[3]++, null);

  let messageForInitiallyOpenFile = (cov_2mhq4ffnwk.s[4]++, null);
  let messageForInitiallyClosedFile = (cov_2mhq4ffnwk.s[5]++, null);

  let initiallyOpenEditor = (cov_2mhq4ffnwk.s[6]++, null);

  cov_2mhq4ffnwk.s[7]++;
  beforeEach(() => {
    cov_2mhq4ffnwk.f[1]++;
    cov_2mhq4ffnwk.s[8]++;

    tracker = new (_MessageRangeTracker || _load_MessageRangeTracker()).default();

    const fixturesPath = (cov_2mhq4ffnwk.s[9]++, (_nuclideUri || _load_nuclideUri()).default.join(__dirname, 'fixtures'));
    cov_2mhq4ffnwk.s[10]++;
    initiallyOpenFilePath = (_nuclideUri || _load_nuclideUri()).default.join(fixturesPath, 'initiallyOpenFile.txt');
    cov_2mhq4ffnwk.s[11]++;
    initiallyClosedFilePath = (_nuclideUri || _load_nuclideUri()).default.join(fixturesPath, 'initiallyClosedFile.txt');

    cov_2mhq4ffnwk.s[12]++;
    messageForInitiallyOpenFile = {
      scope: 'file',
      providerName: 'test',
      type: 'Error',
      filePath: initiallyOpenFilePath,
      text: 'something is wrong',
      range: new _atom.Range([1, 18], [1, 22]),
      fix: {
        oldRange: new _atom.Range([1, 18], [1, 22]),
        oldText: 'test',
        newText: 'fix'
      }
    };

    cov_2mhq4ffnwk.s[13]++;
    messageForInitiallyClosedFile = {
      scope: 'file',
      providerName: 'test',
      type: 'Error',
      filePath: initiallyClosedFilePath,
      text: 'something is wrong',
      range: new _atom.Range([1, 4], [1, 31]),
      fix: {
        oldRange: new _atom.Range([1, 4], [1, 31]),
        oldText: 'at first this one is closed',
        newText: 'now this one is open'
      }
    };

    cov_2mhq4ffnwk.s[14]++;
    waitsForPromise((0, _asyncToGenerator.default)(function* () {
      cov_2mhq4ffnwk.f[2]++;
      cov_2mhq4ffnwk.s[15]++;

      initiallyOpenEditor = yield atom.workspace.open(initiallyOpenFilePath);
    }));
  });

  cov_2mhq4ffnwk.s[16]++;
  afterEach(() => {
    cov_2mhq4ffnwk.f[3]++;
    cov_2mhq4ffnwk.s[17]++;

    for (const editor of atom.workspace.getTextEditors()) {
      cov_2mhq4ffnwk.s[18]++;

      editor.destroy();
    }
  });

  cov_2mhq4ffnwk.s[19]++;
  it('should return ranges for already-open files', () => {
    cov_2mhq4ffnwk.f[4]++;
    cov_2mhq4ffnwk.s[20]++;

    tracker.addFileMessages([messageForInitiallyOpenFile]);
    const range = (cov_2mhq4ffnwk.s[21]++, tracker.getCurrentRange(messageForInitiallyOpenFile));
    cov_2mhq4ffnwk.s[22]++;

    if (!(range != null)) {
      throw new Error('Invariant violation: "range != null"');
    }

    cov_2mhq4ffnwk.s[23]++;

    expect(range.isEqual(new _atom.Range([1, 18], [1, 22]))).toBeTruthy();
    cov_2mhq4ffnwk.s[24]++;
    checkRep(tracker);
  });

  cov_2mhq4ffnwk.s[25]++;
  it('should correctly track changes using markers', () => {
    cov_2mhq4ffnwk.f[5]++;
    cov_2mhq4ffnwk.s[26]++;

    tracker.addFileMessages([messageForInitiallyOpenFile]);
    cov_2mhq4ffnwk.s[27]++;
    initiallyOpenEditor.setTextInBufferRange(new _atom.Range([1, 3], [1, 11]), 'are using');
    const range = (cov_2mhq4ffnwk.s[28]++, tracker.getCurrentRange(messageForInitiallyOpenFile));
    cov_2mhq4ffnwk.s[29]++;

    if (!(range != null)) {
      throw new Error('Invariant violation: "range != null"');
    }

    cov_2mhq4ffnwk.s[30]++;

    expect(range.isEqual(new _atom.Range([1, 19], [1, 23]))).toBeTruthy();
    cov_2mhq4ffnwk.s[31]++;
    checkRep(tracker);
  });

  cov_2mhq4ffnwk.s[32]++;
  it('should invalidate fixes where the oldRange has been touched', () => {
    cov_2mhq4ffnwk.f[6]++;
    cov_2mhq4ffnwk.s[33]++;

    tracker.addFileMessages([messageForInitiallyOpenFile]);
    cov_2mhq4ffnwk.s[34]++;
    initiallyOpenEditor.setTextInBufferRange(new _atom.Range([1, 20], [1, 21]), '');
    const range = (cov_2mhq4ffnwk.s[35]++, tracker.getCurrentRange(messageForInitiallyOpenFile));
    cov_2mhq4ffnwk.s[36]++;
    expect(range).toBeNull();
    cov_2mhq4ffnwk.s[37]++;
    checkRep(tracker);
  });

  cov_2mhq4ffnwk.s[38]++;
  it('should add markers to files when they are opened', () => {
    cov_2mhq4ffnwk.f[7]++;
    cov_2mhq4ffnwk.s[39]++;

    waitsForPromise((0, _asyncToGenerator.default)(function* () {
      cov_2mhq4ffnwk.f[8]++;
      cov_2mhq4ffnwk.s[40]++;

      tracker.addFileMessages([messageForInitiallyClosedFile]);
      cov_2mhq4ffnwk.s[41]++;
      checkRep(tracker);
      cov_2mhq4ffnwk.s[42]++;
      expect(tracker.getCurrentRange(messageForInitiallyClosedFile)).toBeNull();
      const initiallyClosedEditor = (cov_2mhq4ffnwk.s[43]++, yield atom.workspace.open(initiallyClosedFilePath));
      let range = (cov_2mhq4ffnwk.s[44]++, tracker.getCurrentRange(messageForInitiallyClosedFile));
      cov_2mhq4ffnwk.s[45]++;

      if (!(range != null)) {
        throw new Error('Invariant violation: "range != null"');
      }

      cov_2mhq4ffnwk.s[46]++;

      expect(range.isEqual(new _atom.Range([1, 4], [1, 31]))).toBeTruthy();

      cov_2mhq4ffnwk.s[47]++;
      initiallyClosedEditor.setTextInBufferRange(new _atom.Range([0, 16], [0, 16]), '\n');

      cov_2mhq4ffnwk.s[48]++;
      range = tracker.getCurrentRange(messageForInitiallyClosedFile);
      cov_2mhq4ffnwk.s[49]++;

      if (!(range != null)) {
        throw new Error('Invariant violation: "range != null"');
      }

      cov_2mhq4ffnwk.s[50]++;

      expect(range.isEqual(new _atom.Range([2, 4], [2, 31]))).toBeTruthy();
      cov_2mhq4ffnwk.s[51]++;
      checkRep(tracker);
    }));
  });

  // The tests below break the MessageRangeTracker abstraction so that they can ensure that disposal
  // happens properly.

  cov_2mhq4ffnwk.s[52]++;
  it('should remove messages for open files and destroy markers', () => {
    cov_2mhq4ffnwk.f[9]++;
    cov_2mhq4ffnwk.s[53]++;

    tracker.addFileMessages([messageForInitiallyOpenFile]);
    const messageSet = (cov_2mhq4ffnwk.s[54]++, tracker._fileToMessages.get(initiallyOpenFilePath));
    cov_2mhq4ffnwk.s[55]++;

    if (!(messageSet != null)) {
      throw new Error('Invariant violation: "messageSet != null"');
    }

    cov_2mhq4ffnwk.s[56]++;

    expect(messageSet.has(messageForInitiallyOpenFile)).toBeTruthy();
    const marker = (cov_2mhq4ffnwk.s[57]++, tracker._messageToMarker.get(messageForInitiallyOpenFile));
    cov_2mhq4ffnwk.s[58]++;

    if (!(marker != null)) {
      throw new Error('Invariant violation: "marker != null"');
    }

    cov_2mhq4ffnwk.s[59]++;


    checkRep(tracker);

    cov_2mhq4ffnwk.s[60]++;
    tracker.removeFileMessages([messageForInitiallyOpenFile]);
    cov_2mhq4ffnwk.s[61]++;
    expect(tracker._fileToMessages.hasAny(initiallyOpenFilePath)).toBeFalsy();
    cov_2mhq4ffnwk.s[62]++;
    expect(tracker._messageToMarker.has(messageForInitiallyOpenFile)).toBeFalsy();
    cov_2mhq4ffnwk.s[63]++;
    expect(marker.isDestroyed()).toBeTruthy();

    cov_2mhq4ffnwk.s[64]++;
    checkRep(tracker);
  });

  cov_2mhq4ffnwk.s[65]++;
  it('should remove messages for closed files', () => {
    cov_2mhq4ffnwk.f[10]++;
    cov_2mhq4ffnwk.s[66]++;

    tracker.addFileMessages([messageForInitiallyClosedFile]);
    cov_2mhq4ffnwk.s[67]++;
    expect(tracker._messageToMarker.has(messageForInitiallyClosedFile)).toBeFalsy();
    const messagesSet = (cov_2mhq4ffnwk.s[68]++, tracker._fileToMessages.get(initiallyClosedFilePath));
    cov_2mhq4ffnwk.s[69]++;

    if (!(messagesSet != null)) {
      throw new Error('Invariant violation: "messagesSet != null"');
    }

    cov_2mhq4ffnwk.s[70]++;

    expect(messagesSet.has(messageForInitiallyClosedFile)).toBeTruthy();

    cov_2mhq4ffnwk.s[71]++;
    tracker.removeFileMessages([messageForInitiallyClosedFile]);
    cov_2mhq4ffnwk.s[72]++;
    expect(tracker._fileToMessages.hasAny(initiallyClosedFilePath)).toBeFalsy();

    cov_2mhq4ffnwk.s[73]++;
    checkRep(tracker);
  });

  cov_2mhq4ffnwk.s[74]++;
  it('should properly clean up when a text buffer is closed', () => {
    cov_2mhq4ffnwk.f[11]++;
    cov_2mhq4ffnwk.s[75]++;

    tracker.addFileMessages([messageForInitiallyOpenFile]);
    const marker = (cov_2mhq4ffnwk.s[76]++, tracker._messageToMarker.get(messageForInitiallyOpenFile));
    cov_2mhq4ffnwk.s[77]++;

    if (!(marker != null)) {
      throw new Error('Invariant violation: "marker != null"');
    }

    cov_2mhq4ffnwk.s[78]++;


    initiallyOpenEditor.destroy();

    const messageSet = (cov_2mhq4ffnwk.s[79]++, tracker._fileToMessages.get(initiallyOpenFilePath));
    cov_2mhq4ffnwk.s[80]++;

    if (!(messageSet != null)) {
      throw new Error('Invariant violation: "messageSet != null"');
    }

    cov_2mhq4ffnwk.s[81]++;


    expect(messageSet.has(messageForInitiallyOpenFile)).toBeTruthy();

    cov_2mhq4ffnwk.s[82]++;
    expect(tracker._messageToMarker.has(messageForInitiallyOpenFile)).toBeFalsy();

    cov_2mhq4ffnwk.s[83]++;
    expect(marker.isDestroyed()).toBeTruthy();

    cov_2mhq4ffnwk.s[84]++;
    checkRep(tracker);
  });

  cov_2mhq4ffnwk.s[85]++;
  it('should clean up when disposed', () => {
    cov_2mhq4ffnwk.f[12]++;
    cov_2mhq4ffnwk.s[86]++;

    tracker.addFileMessages([messageForInitiallyOpenFile]);
    const marker = (cov_2mhq4ffnwk.s[87]++, tracker._messageToMarker.get(messageForInitiallyOpenFile));
    cov_2mhq4ffnwk.s[88]++;

    if (!(marker != null)) {
      throw new Error('Invariant violation: "marker != null"');
    }

    cov_2mhq4ffnwk.s[89]++;


    expect(marker.isDestroyed()).toBeFalsy();
    cov_2mhq4ffnwk.s[90]++;
    tracker.dispose();
    cov_2mhq4ffnwk.s[91]++;
    expect(marker.isDestroyed()).toBeTruthy();

    cov_2mhq4ffnwk.s[92]++;
    expect(tracker._fileToMessages.size).toBe(0);
    cov_2mhq4ffnwk.s[93]++;
    expect(tracker._messageToMarker.size).toBe(0);

    cov_2mhq4ffnwk.s[94]++;
    checkRep(tracker);
  });
});

/**
 * Ensures that the representation invariants hold. Obviously, this breaks abstraction by reaching
 * into private properties.
 */
function checkRep(tracker) {
  cov_2mhq4ffnwk.f[13]++;

  const openFiles = (cov_2mhq4ffnwk.s[95]++, new Set(atom.workspace.getTextEditors().map(editor => {
    cov_2mhq4ffnwk.f[14]++;
    cov_2mhq4ffnwk.s[96]++;
    return editor.getPath();
  })));

  cov_2mhq4ffnwk.s[97]++;
  for (const message of tracker._messageToMarker.keys()) {
    cov_2mhq4ffnwk.s[98]++;

    expect(openFiles.has(message.filePath)).toBeTruthy();
  }

  cov_2mhq4ffnwk.s[99]++;
  for (const marker of tracker._messageToMarker.values()) {
    cov_2mhq4ffnwk.s[100]++;

    expect(marker.isDestroyed()).toBeFalsy();
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1lc3NhZ2VSYW5nZVRyYWNrZXItc3BlYy5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsInRyYWNrZXIiLCJpbml0aWFsbHlPcGVuRmlsZVBhdGgiLCJpbml0aWFsbHlDbG9zZWRGaWxlUGF0aCIsIm1lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZSIsIm1lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlIiwiaW5pdGlhbGx5T3BlbkVkaXRvciIsImJlZm9yZUVhY2giLCJmaXh0dXJlc1BhdGgiLCJqb2luIiwiX19kaXJuYW1lIiwic2NvcGUiLCJwcm92aWRlck5hbWUiLCJ0eXBlIiwiZmlsZVBhdGgiLCJ0ZXh0IiwicmFuZ2UiLCJmaXgiLCJvbGRSYW5nZSIsIm9sZFRleHQiLCJuZXdUZXh0Iiwid2FpdHNGb3JQcm9taXNlIiwiYXRvbSIsIndvcmtzcGFjZSIsIm9wZW4iLCJhZnRlckVhY2giLCJlZGl0b3IiLCJnZXRUZXh0RWRpdG9ycyIsImRlc3Ryb3kiLCJpdCIsImFkZEZpbGVNZXNzYWdlcyIsImdldEN1cnJlbnRSYW5nZSIsImV4cGVjdCIsImlzRXF1YWwiLCJ0b0JlVHJ1dGh5IiwiY2hlY2tSZXAiLCJzZXRUZXh0SW5CdWZmZXJSYW5nZSIsInRvQmVOdWxsIiwiaW5pdGlhbGx5Q2xvc2VkRWRpdG9yIiwibWVzc2FnZVNldCIsIl9maWxlVG9NZXNzYWdlcyIsImdldCIsImhhcyIsIm1hcmtlciIsIl9tZXNzYWdlVG9NYXJrZXIiLCJyZW1vdmVGaWxlTWVzc2FnZXMiLCJoYXNBbnkiLCJ0b0JlRmFsc3kiLCJpc0Rlc3Ryb3llZCIsIm1lc3NhZ2VzU2V0IiwiZGlzcG9zZSIsInNpemUiLCJ0b0JlIiwib3BlbkZpbGVzIiwiU2V0IiwibWFwIiwiZ2V0UGF0aCIsIm1lc3NhZ2UiLCJrZXlzIiwidmFsdWVzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFoQyxFQUFzQ0MsSUFBdEMsQ0FBMkMsQ0FBM0M7O0FBVndDO0FBWXhDakIsYUFBU2xDLE9BQVQ7QUFDRCxHQWJEO0FBY0QsQ0E1TEQ7O0FBOExBOzs7O0FBSUEsU0FBU2tDLFFBQVQsQ0FBa0JsQyxPQUFsQixFQUFzRDtBQUFBOztBQUNwRCxRQUFNb0QscUNBQVksSUFBSUMsR0FBSixDQUNoQmhDLEtBQUtDLFNBQUwsQ0FBZUksY0FBZixHQUFnQzRCLEdBQWhDLENBQW9DN0IsVUFBVTtBQUFBO0FBQUE7QUFBQSxrQkFBTzhCLE9BQVA7QUFBZ0IsR0FBOUQsQ0FEZ0IsQ0FBWixDQUFOOztBQURvRDtBQUtwRCxPQUFLLE1BQU1DLE9BQVgsSUFBc0J4RCxRQUFRMkMsZ0JBQVIsQ0FBeUJjLElBQXpCLEVBQXRCLEVBQXVEO0FBQUE7O0FBQ3JEMUIsV0FBT3FCLFVBQVVYLEdBQVYsQ0FBY2UsUUFBUTNDLFFBQXRCLENBQVAsRUFBd0NvQixVQUF4QztBQUNEOztBQVBtRDtBQVNwRCxPQUFLLE1BQU1TLE1BQVgsSUFBcUIxQyxRQUFRMkMsZ0JBQVIsQ0FBeUJlLE1BQXpCLEVBQXJCLEVBQXdEO0FBQUE7O0FBQ3REM0IsV0FBT1csT0FBT0ssV0FBUCxFQUFQLEVBQTZCRCxTQUE3QjtBQUNEO0FBQ0YiLCJmaWxlIjoiTWVzc2FnZVJhbmdlVHJhY2tlci1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHR5cGUge0ZpbGVEaWFnbm9zdGljTWVzc2FnZX0gZnJvbSAnLi4vbGliL3R5cGVzJztcblxuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuaW1wb3J0IHtSYW5nZX0gZnJvbSAnYXRvbSc7XG5cbmltcG9ydCBNZXNzYWdlUmFuZ2VUcmFja2VyIGZyb20gJy4uL2xpYi9NZXNzYWdlUmFuZ2VUcmFja2VyJztcblxuaW1wb3J0IG51Y2xpZGVVcmkgZnJvbSAnbnVjbGlkZS1jb21tb25zL251Y2xpZGVVcmknO1xuXG5kZXNjcmliZSgnTWVzc2FnZVJhbmdlVHJhY2tlcicsICgpID0+IHtcbiAgbGV0IHRyYWNrZXI6IE1lc3NhZ2VSYW5nZVRyYWNrZXIgPSAobnVsbDogYW55KTtcblxuICBsZXQgaW5pdGlhbGx5T3BlbkZpbGVQYXRoOiBzdHJpbmcgPSAobnVsbDogYW55KTtcbiAgbGV0IGluaXRpYWxseUNsb3NlZEZpbGVQYXRoOiBzdHJpbmcgPSAobnVsbDogYW55KTtcblxuICBsZXQgbWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlOiBGaWxlRGlhZ25vc3RpY01lc3NhZ2UgPSAobnVsbDogYW55KTtcbiAgbGV0IG1lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlOiBGaWxlRGlhZ25vc3RpY01lc3NhZ2UgPSAobnVsbDogYW55KTtcblxuICBsZXQgaW5pdGlhbGx5T3BlbkVkaXRvcjogYXRvbSRUZXh0RWRpdG9yID0gKG51bGw6IGFueSk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgdHJhY2tlciA9IG5ldyBNZXNzYWdlUmFuZ2VUcmFja2VyKCk7XG5cbiAgICBjb25zdCBmaXh0dXJlc1BhdGggPSBudWNsaWRlVXJpLmpvaW4oX19kaXJuYW1lLCAnZml4dHVyZXMnKTtcbiAgICBpbml0aWFsbHlPcGVuRmlsZVBhdGggPSBudWNsaWRlVXJpLmpvaW4oXG4gICAgICBmaXh0dXJlc1BhdGgsXG4gICAgICAnaW5pdGlhbGx5T3BlbkZpbGUudHh0JyxcbiAgICApO1xuICAgIGluaXRpYWxseUNsb3NlZEZpbGVQYXRoID0gbnVjbGlkZVVyaS5qb2luKFxuICAgICAgZml4dHVyZXNQYXRoLFxuICAgICAgJ2luaXRpYWxseUNsb3NlZEZpbGUudHh0JyxcbiAgICApO1xuXG4gICAgbWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlID0ge1xuICAgICAgc2NvcGU6ICdmaWxlJyxcbiAgICAgIHByb3ZpZGVyTmFtZTogJ3Rlc3QnLFxuICAgICAgdHlwZTogJ0Vycm9yJyxcbiAgICAgIGZpbGVQYXRoOiBpbml0aWFsbHlPcGVuRmlsZVBhdGgsXG4gICAgICB0ZXh0OiAnc29tZXRoaW5nIGlzIHdyb25nJyxcbiAgICAgIHJhbmdlOiBuZXcgUmFuZ2UoWzEsIDE4XSwgWzEsIDIyXSksXG4gICAgICBmaXg6IHtcbiAgICAgICAgb2xkUmFuZ2U6IG5ldyBSYW5nZShbMSwgMThdLCBbMSwgMjJdKSxcbiAgICAgICAgb2xkVGV4dDogJ3Rlc3QnLFxuICAgICAgICBuZXdUZXh0OiAnZml4JyxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIG1lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlID0ge1xuICAgICAgc2NvcGU6ICdmaWxlJyxcbiAgICAgIHByb3ZpZGVyTmFtZTogJ3Rlc3QnLFxuICAgICAgdHlwZTogJ0Vycm9yJyxcbiAgICAgIGZpbGVQYXRoOiBpbml0aWFsbHlDbG9zZWRGaWxlUGF0aCxcbiAgICAgIHRleHQ6ICdzb21ldGhpbmcgaXMgd3JvbmcnLFxuICAgICAgcmFuZ2U6IG5ldyBSYW5nZShbMSwgNF0sIFsxLCAzMV0pLFxuICAgICAgZml4OiB7XG4gICAgICAgIG9sZFJhbmdlOiBuZXcgUmFuZ2UoWzEsIDRdLCBbMSwgMzFdKSxcbiAgICAgICAgb2xkVGV4dDogJ2F0IGZpcnN0IHRoaXMgb25lIGlzIGNsb3NlZCcsXG4gICAgICAgIG5ld1RleHQ6ICdub3cgdGhpcyBvbmUgaXMgb3BlbicsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICB3YWl0c0ZvclByb21pc2UoYXN5bmMgKCkgPT4ge1xuICAgICAgaW5pdGlhbGx5T3BlbkVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oaW5pdGlhbGx5T3BlbkZpbGVQYXRoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBmb3IgKGNvbnN0IGVkaXRvciBvZiBhdG9tLndvcmtzcGFjZS5nZXRUZXh0RWRpdG9ycygpKSB7XG4gICAgICBlZGl0b3IuZGVzdHJveSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZXR1cm4gcmFuZ2VzIGZvciBhbHJlYWR5LW9wZW4gZmlsZXMnLCAoKSA9PiB7XG4gICAgdHJhY2tlci5hZGRGaWxlTWVzc2FnZXMoW21lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZV0pO1xuICAgIGNvbnN0IHJhbmdlID0gdHJhY2tlci5nZXRDdXJyZW50UmFuZ2UobWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlKTtcbiAgICBpbnZhcmlhbnQocmFuZ2UgIT0gbnVsbCk7XG4gICAgZXhwZWN0KHJhbmdlLmlzRXF1YWwobmV3IFJhbmdlKFsxLCAxOF0sIFsxLCAyMl0pKSkudG9CZVRydXRoeSgpO1xuICAgIGNoZWNrUmVwKHRyYWNrZXIpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGNvcnJlY3RseSB0cmFjayBjaGFuZ2VzIHVzaW5nIG1hcmtlcnMnLCAoKSA9PiB7XG4gICAgdHJhY2tlci5hZGRGaWxlTWVzc2FnZXMoW21lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZV0pO1xuICAgIGluaXRpYWxseU9wZW5FZGl0b3Iuc2V0VGV4dEluQnVmZmVyUmFuZ2UoXG4gICAgICBuZXcgUmFuZ2UoWzEsIDNdLCBbMSwgMTFdKSxcbiAgICAgICdhcmUgdXNpbmcnLFxuICAgICk7XG4gICAgY29uc3QgcmFuZ2UgPSB0cmFja2VyLmdldEN1cnJlbnRSYW5nZShtZXNzYWdlRm9ySW5pdGlhbGx5T3BlbkZpbGUpO1xuICAgIGludmFyaWFudChyYW5nZSAhPSBudWxsKTtcbiAgICBleHBlY3QocmFuZ2UuaXNFcXVhbChuZXcgUmFuZ2UoWzEsIDE5XSwgWzEsIDIzXSkpKS50b0JlVHJ1dGh5KCk7XG4gICAgY2hlY2tSZXAodHJhY2tlcik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaW52YWxpZGF0ZSBmaXhlcyB3aGVyZSB0aGUgb2xkUmFuZ2UgaGFzIGJlZW4gdG91Y2hlZCcsICgpID0+IHtcbiAgICB0cmFja2VyLmFkZEZpbGVNZXNzYWdlcyhbbWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlXSk7XG4gICAgaW5pdGlhbGx5T3BlbkVkaXRvci5zZXRUZXh0SW5CdWZmZXJSYW5nZShuZXcgUmFuZ2UoWzEsIDIwXSwgWzEsIDIxXSksICcnKTtcbiAgICBjb25zdCByYW5nZSA9IHRyYWNrZXIuZ2V0Q3VycmVudFJhbmdlKG1lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZSk7XG4gICAgZXhwZWN0KHJhbmdlKS50b0JlTnVsbCgpO1xuICAgIGNoZWNrUmVwKHRyYWNrZXIpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGFkZCBtYXJrZXJzIHRvIGZpbGVzIHdoZW4gdGhleSBhcmUgb3BlbmVkJywgKCkgPT4ge1xuICAgIHdhaXRzRm9yUHJvbWlzZShhc3luYyAoKSA9PiB7XG4gICAgICB0cmFja2VyLmFkZEZpbGVNZXNzYWdlcyhbbWVzc2FnZUZvckluaXRpYWxseUNsb3NlZEZpbGVdKTtcbiAgICAgIGNoZWNrUmVwKHRyYWNrZXIpO1xuICAgICAgZXhwZWN0KHRyYWNrZXIuZ2V0Q3VycmVudFJhbmdlKG1lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlKSkudG9CZU51bGwoKTtcbiAgICAgIGNvbnN0IGluaXRpYWxseUNsb3NlZEVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oXG4gICAgICAgIGluaXRpYWxseUNsb3NlZEZpbGVQYXRoLFxuICAgICAgKTtcbiAgICAgIGxldCByYW5nZSA9IHRyYWNrZXIuZ2V0Q3VycmVudFJhbmdlKG1lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlKTtcbiAgICAgIGludmFyaWFudChyYW5nZSAhPSBudWxsKTtcbiAgICAgIGV4cGVjdChyYW5nZS5pc0VxdWFsKG5ldyBSYW5nZShbMSwgNF0sIFsxLCAzMV0pKSkudG9CZVRydXRoeSgpO1xuXG4gICAgICBpbml0aWFsbHlDbG9zZWRFZGl0b3Iuc2V0VGV4dEluQnVmZmVyUmFuZ2UoXG4gICAgICAgIG5ldyBSYW5nZShbMCwgMTZdLCBbMCwgMTZdKSxcbiAgICAgICAgJ1xcbicsXG4gICAgICApO1xuXG4gICAgICByYW5nZSA9IHRyYWNrZXIuZ2V0Q3VycmVudFJhbmdlKG1lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlKTtcbiAgICAgIGludmFyaWFudChyYW5nZSAhPSBudWxsKTtcbiAgICAgIGV4cGVjdChyYW5nZS5pc0VxdWFsKG5ldyBSYW5nZShbMiwgNF0sIFsyLCAzMV0pKSkudG9CZVRydXRoeSgpO1xuICAgICAgY2hlY2tSZXAodHJhY2tlcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIFRoZSB0ZXN0cyBiZWxvdyBicmVhayB0aGUgTWVzc2FnZVJhbmdlVHJhY2tlciBhYnN0cmFjdGlvbiBzbyB0aGF0IHRoZXkgY2FuIGVuc3VyZSB0aGF0IGRpc3Bvc2FsXG4gIC8vIGhhcHBlbnMgcHJvcGVybHkuXG5cbiAgaXQoJ3Nob3VsZCByZW1vdmUgbWVzc2FnZXMgZm9yIG9wZW4gZmlsZXMgYW5kIGRlc3Ryb3kgbWFya2VycycsICgpID0+IHtcbiAgICB0cmFja2VyLmFkZEZpbGVNZXNzYWdlcyhbbWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlXSk7XG4gICAgY29uc3QgbWVzc2FnZVNldCA9IHRyYWNrZXIuX2ZpbGVUb01lc3NhZ2VzLmdldChpbml0aWFsbHlPcGVuRmlsZVBhdGgpO1xuICAgIGludmFyaWFudChtZXNzYWdlU2V0ICE9IG51bGwpO1xuICAgIGV4cGVjdChtZXNzYWdlU2V0LmhhcyhtZXNzYWdlRm9ySW5pdGlhbGx5T3BlbkZpbGUpKS50b0JlVHJ1dGh5KCk7XG4gICAgY29uc3QgbWFya2VyID0gdHJhY2tlci5fbWVzc2FnZVRvTWFya2VyLmdldChtZXNzYWdlRm9ySW5pdGlhbGx5T3BlbkZpbGUpO1xuICAgIGludmFyaWFudChtYXJrZXIgIT0gbnVsbCk7XG5cbiAgICBjaGVja1JlcCh0cmFja2VyKTtcblxuICAgIHRyYWNrZXIucmVtb3ZlRmlsZU1lc3NhZ2VzKFttZXNzYWdlRm9ySW5pdGlhbGx5T3BlbkZpbGVdKTtcbiAgICBleHBlY3QodHJhY2tlci5fZmlsZVRvTWVzc2FnZXMuaGFzQW55KGluaXRpYWxseU9wZW5GaWxlUGF0aCkpLnRvQmVGYWxzeSgpO1xuICAgIGV4cGVjdChcbiAgICAgIHRyYWNrZXIuX21lc3NhZ2VUb01hcmtlci5oYXMobWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlKSxcbiAgICApLnRvQmVGYWxzeSgpO1xuICAgIGV4cGVjdChtYXJrZXIuaXNEZXN0cm95ZWQoKSkudG9CZVRydXRoeSgpO1xuXG4gICAgY2hlY2tSZXAodHJhY2tlcik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmVtb3ZlIG1lc3NhZ2VzIGZvciBjbG9zZWQgZmlsZXMnLCAoKSA9PiB7XG4gICAgdHJhY2tlci5hZGRGaWxlTWVzc2FnZXMoW21lc3NhZ2VGb3JJbml0aWFsbHlDbG9zZWRGaWxlXSk7XG4gICAgZXhwZWN0KFxuICAgICAgdHJhY2tlci5fbWVzc2FnZVRvTWFya2VyLmhhcyhtZXNzYWdlRm9ySW5pdGlhbGx5Q2xvc2VkRmlsZSksXG4gICAgKS50b0JlRmFsc3koKTtcbiAgICBjb25zdCBtZXNzYWdlc1NldCA9IHRyYWNrZXIuX2ZpbGVUb01lc3NhZ2VzLmdldChpbml0aWFsbHlDbG9zZWRGaWxlUGF0aCk7XG4gICAgaW52YXJpYW50KG1lc3NhZ2VzU2V0ICE9IG51bGwpO1xuICAgIGV4cGVjdChtZXNzYWdlc1NldC5oYXMobWVzc2FnZUZvckluaXRpYWxseUNsb3NlZEZpbGUpKS50b0JlVHJ1dGh5KCk7XG5cbiAgICB0cmFja2VyLnJlbW92ZUZpbGVNZXNzYWdlcyhbbWVzc2FnZUZvckluaXRpYWxseUNsb3NlZEZpbGVdKTtcbiAgICBleHBlY3QodHJhY2tlci5fZmlsZVRvTWVzc2FnZXMuaGFzQW55KGluaXRpYWxseUNsb3NlZEZpbGVQYXRoKSkudG9CZUZhbHN5KCk7XG5cbiAgICBjaGVja1JlcCh0cmFja2VyKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBwcm9wZXJseSBjbGVhbiB1cCB3aGVuIGEgdGV4dCBidWZmZXIgaXMgY2xvc2VkJywgKCkgPT4ge1xuICAgIHRyYWNrZXIuYWRkRmlsZU1lc3NhZ2VzKFttZXNzYWdlRm9ySW5pdGlhbGx5T3BlbkZpbGVdKTtcbiAgICBjb25zdCBtYXJrZXIgPSB0cmFja2VyLl9tZXNzYWdlVG9NYXJrZXIuZ2V0KG1lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZSk7XG4gICAgaW52YXJpYW50KG1hcmtlciAhPSBudWxsKTtcblxuICAgIGluaXRpYWxseU9wZW5FZGl0b3IuZGVzdHJveSgpO1xuXG4gICAgY29uc3QgbWVzc2FnZVNldCA9IHRyYWNrZXIuX2ZpbGVUb01lc3NhZ2VzLmdldChpbml0aWFsbHlPcGVuRmlsZVBhdGgpO1xuICAgIGludmFyaWFudChtZXNzYWdlU2V0ICE9IG51bGwpO1xuXG4gICAgZXhwZWN0KG1lc3NhZ2VTZXQuaGFzKG1lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZSkpLnRvQmVUcnV0aHkoKTtcblxuICAgIGV4cGVjdChcbiAgICAgIHRyYWNrZXIuX21lc3NhZ2VUb01hcmtlci5oYXMobWVzc2FnZUZvckluaXRpYWxseU9wZW5GaWxlKSxcbiAgICApLnRvQmVGYWxzeSgpO1xuXG4gICAgZXhwZWN0KG1hcmtlci5pc0Rlc3Ryb3llZCgpKS50b0JlVHJ1dGh5KCk7XG5cbiAgICBjaGVja1JlcCh0cmFja2VyKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBjbGVhbiB1cCB3aGVuIGRpc3Bvc2VkJywgKCkgPT4ge1xuICAgIHRyYWNrZXIuYWRkRmlsZU1lc3NhZ2VzKFttZXNzYWdlRm9ySW5pdGlhbGx5T3BlbkZpbGVdKTtcbiAgICBjb25zdCBtYXJrZXIgPSB0cmFja2VyLl9tZXNzYWdlVG9NYXJrZXIuZ2V0KG1lc3NhZ2VGb3JJbml0aWFsbHlPcGVuRmlsZSk7XG4gICAgaW52YXJpYW50KG1hcmtlciAhPSBudWxsKTtcblxuICAgIGV4cGVjdChtYXJrZXIuaXNEZXN0cm95ZWQoKSkudG9CZUZhbHN5KCk7XG4gICAgdHJhY2tlci5kaXNwb3NlKCk7XG4gICAgZXhwZWN0KG1hcmtlci5pc0Rlc3Ryb3llZCgpKS50b0JlVHJ1dGh5KCk7XG5cbiAgICBleHBlY3QodHJhY2tlci5fZmlsZVRvTWVzc2FnZXMuc2l6ZSkudG9CZSgwKTtcbiAgICBleHBlY3QodHJhY2tlci5fbWVzc2FnZVRvTWFya2VyLnNpemUpLnRvQmUoMCk7XG5cbiAgICBjaGVja1JlcCh0cmFja2VyKTtcbiAgfSk7XG59KTtcblxuLyoqXG4gKiBFbnN1cmVzIHRoYXQgdGhlIHJlcHJlc2VudGF0aW9uIGludmFyaWFudHMgaG9sZC4gT2J2aW91c2x5LCB0aGlzIGJyZWFrcyBhYnN0cmFjdGlvbiBieSByZWFjaGluZ1xuICogaW50byBwcml2YXRlIHByb3BlcnRpZXMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrUmVwKHRyYWNrZXI6IE1lc3NhZ2VSYW5nZVRyYWNrZXIpOiB2b2lkIHtcbiAgY29uc3Qgb3BlbkZpbGVzID0gbmV3IFNldChcbiAgICBhdG9tLndvcmtzcGFjZS5nZXRUZXh0RWRpdG9ycygpLm1hcChlZGl0b3IgPT4gZWRpdG9yLmdldFBhdGgoKSksXG4gICk7XG5cbiAgZm9yIChjb25zdCBtZXNzYWdlIG9mIHRyYWNrZXIuX21lc3NhZ2VUb01hcmtlci5rZXlzKCkpIHtcbiAgICBleHBlY3Qob3BlbkZpbGVzLmhhcyhtZXNzYWdlLmZpbGVQYXRoKSkudG9CZVRydXRoeSgpO1xuICB9XG5cbiAgZm9yIChjb25zdCBtYXJrZXIgb2YgdHJhY2tlci5fbWVzc2FnZVRvTWFya2VyLnZhbHVlcygpKSB7XG4gICAgZXhwZWN0KG1hcmtlci5pc0Rlc3Ryb3llZCgpKS50b0JlRmFsc3koKTtcbiAgfVxufVxuIl19