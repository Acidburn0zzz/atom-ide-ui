'use strict';

var cov_2hc1b1ocab = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-atom/spec/projects-spec.js',
      hash = '3c40c8e0c80342c50a0fd2129cc37fca098d9c58',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-atom/spec/projects-spec.js',
    statementMap: {
      '0': {
        start: {
          line: 23,
          column: 0
        },
        end: {
          line: 117,
          column: 3
        }
      },
      '1': {
        start: {
          line: 24,
          column: 34
        },
        end: {
          line: 24,
          column: 43
        }
      },
      '2': {
        start: {
          line: 25,
          column: 34
        },
        end: {
          line: 25,
          column: 43
        }
      },
      '3': {
        start: {
          line: 27,
          column: 2
        },
        end: {
          line: 32,
          column: 5
        }
      },
      '4': {
        start: {
          line: 28,
          column: 4
        },
        end: {
          line: 28,
          column: 17
        }
      },
      '5': {
        start: {
          line: 30,
          column: 4
        },
        end: {
          line: 30,
          column: 58
        }
      },
      '6': {
        start: {
          line: 31,
          column: 4
        },
        end: {
          line: 31,
          column: 58
        }
      },
      '7': {
        start: {
          line: 34,
          column: 2
        },
        end: {
          line: 47,
          column: 5
        }
      },
      '8': {
        start: {
          line: 35,
          column: 4
        },
        end: {
          line: 46,
          column: 7
        }
      },
      '9': {
        start: {
          line: 36,
          column: 6
        },
        end: {
          line: 36,
          column: 48
        }
      },
      '10': {
        start: {
          line: 37,
          column: 20
        },
        end: {
          line: 37,
          column: 64
        }
      },
      '11': {
        start: {
          line: 38,
          column: 20
        },
        end: {
          line: 38,
          column: 41
        }
      },
      '12': {
        start: {
          line: 39,
          column: 6
        },
        end: {
          line: 39,
          column: 31
        }
      },
      '13': {
        start: {
          line: 40,
          column: 6
        },
        end: {
          line: 40,
          column: 42
        }
      },
      '14': {
        start: {
          line: 42,
          column: 20
        },
        end: {
          line: 42,
          column: 67
        }
      },
      '15': {
        start: {
          line: 43,
          column: 20
        },
        end: {
          line: 43,
          column: 41
        }
      },
      '16': {
        start: {
          line: 44,
          column: 6
        },
        end: {
          line: 44,
          column: 31
        }
      },
      '17': {
        start: {
          line: 45,
          column: 6
        },
        end: {
          line: 45,
          column: 42
        }
      },
      '18': {
        start: {
          line: 49,
          column: 2
        },
        end: {
          line: 60,
          column: 5
        }
      },
      '19': {
        start: {
          line: 50,
          column: 4
        },
        end: {
          line: 59,
          column: 7
        }
      },
      '20': {
        start: {
          line: 51,
          column: 42
        },
        end: {
          line: 51,
          column: 44
        }
      },
      '21': {
        start: {
          line: 52,
          column: 6
        },
        end: {
          line: 52,
          column: 48
        }
      },
      '22': {
        start: {
          line: 53,
          column: 6
        },
        end: {
          line: 55,
          column: 9
        }
      },
      '23': {
        start: {
          line: 54,
          column: 8
        },
        end: {
          line: 54,
          column: 39
        }
      },
      '24': {
        start: {
          line: 56,
          column: 6
        },
        end: {
          line: 56,
          column: 55
        }
      },
      '25': {
        start: {
          line: 57,
          column: 6
        },
        end: {
          line: 57,
          column: 45
        }
      },
      '26': {
        start: {
          line: 58,
          column: 6
        },
        end: {
          line: 58,
          column: 73
        }
      },
      '27': {
        start: {
          line: 62,
          column: 2
        },
        end: {
          line: 88,
          column: 5
        }
      },
      '28': {
        start: {
          line: 63,
          column: 4
        },
        end: {
          line: 72,
          column: 7
        }
      },
      '29': {
        start: {
          line: 64,
          column: 47
        },
        end: {
          line: 64,
          column: 49
        }
      },
      '30': {
        start: {
          line: 65,
          column: 6
        },
        end: {
          line: 65,
          column: 48
        }
      },
      '31': {
        start: {
          line: 66,
          column: 6
        },
        end: {
          line: 68,
          column: 9
        }
      },
      '32': {
        start: {
          line: 67,
          column: 8
        },
        end: {
          line: 67,
          column: 44
        }
      },
      '33': {
        start: {
          line: 69,
          column: 6
        },
        end: {
          line: 69,
          column: 47
        }
      },
      '34': {
        start: {
          line: 70,
          column: 6
        },
        end: {
          line: 70,
          column: 45
        }
      },
      '35': {
        start: {
          line: 71,
          column: 6
        },
        end: {
          line: 71,
          column: 60
        }
      },
      '36': {
        start: {
          line: 74,
          column: 4
        },
        end: {
          line: 87,
          column: 7
        }
      },
      '37': {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 80,
          column: 70
        }
      },
      '38': {
        start: {
          line: 76,
          column: 8
        },
        end: {
          line: 78,
          column: 11
        }
      },
      '39': {
        start: {
          line: 77,
          column: 10
        },
        end: {
          line: 77,
          column: 49
        }
      },
      '40': {
        start: {
          line: 79,
          column: 8
        },
        end: {
          line: 79,
          column: 50
        }
      },
      '41': {
        start: {
          line: 81,
          column: 6
        },
        end: {
          line: 86,
          column: 70
        }
      },
      '42': {
        start: {
          line: 82,
          column: 8
        },
        end: {
          line: 84,
          column: 11
        }
      },
      '43': {
        start: {
          line: 83,
          column: 10
        },
        end: {
          line: 83,
          column: 52
        }
      },
      '44': {
        start: {
          line: 85,
          column: 8
        },
        end: {
          line: 85,
          column: 50
        }
      },
      '45': {
        start: {
          line: 90,
          column: 2
        },
        end: {
          line: 116,
          column: 5
        }
      },
      '46': {
        start: {
          line: 91,
          column: 4
        },
        end: {
          line: 100,
          column: 7
        }
      },
      '47': {
        start: {
          line: 92,
          column: 49
        },
        end: {
          line: 92,
          column: 51
        }
      },
      '48': {
        start: {
          line: 93,
          column: 6
        },
        end: {
          line: 93,
          column: 48
        }
      },
      '49': {
        start: {
          line: 94,
          column: 6
        },
        end: {
          line: 96,
          column: 9
        }
      },
      '50': {
        start: {
          line: 95,
          column: 8
        },
        end: {
          line: 95,
          column: 46
        }
      },
      '51': {
        start: {
          line: 97,
          column: 6
        },
        end: {
          line: 97,
          column: 49
        }
      },
      '52': {
        start: {
          line: 98,
          column: 6
        },
        end: {
          line: 98,
          column: 48
        }
      },
      '53': {
        start: {
          line: 99,
          column: 6
        },
        end: {
          line: 99,
          column: 62
        }
      },
      '54': {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 115,
          column: 7
        }
      },
      '55': {
        start: {
          line: 103,
          column: 6
        },
        end: {
          line: 108,
          column: 70
        }
      },
      '56': {
        start: {
          line: 104,
          column: 8
        },
        end: {
          line: 106,
          column: 11
        }
      },
      '57': {
        start: {
          line: 105,
          column: 10
        },
        end: {
          line: 105,
          column: 49
        }
      },
      '58': {
        start: {
          line: 107,
          column: 8
        },
        end: {
          line: 107,
          column: 50
        }
      },
      '59': {
        start: {
          line: 109,
          column: 6
        },
        end: {
          line: 114,
          column: 70
        }
      },
      '60': {
        start: {
          line: 110,
          column: 8
        },
        end: {
          line: 112,
          column: 11
        }
      },
      '61': {
        start: {
          line: 111,
          column: 10
        },
        end: {
          line: 111,
          column: 52
        }
      },
      '62': {
        start: {
          line: 113,
          column: 8
        },
        end: {
          line: 113,
          column: 50
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 23,
            column: 21
          },
          end: {
            line: 23,
            column: 22
          }
        },
        loc: {
          start: {
            line: 23,
            column: 27
          },
          end: {
            line: 117,
            column: 1
          }
        },
        line: 23
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 27,
            column: 13
          },
          end: {
            line: 27,
            column: 14
          }
        },
        loc: {
          start: {
            line: 27,
            column: 19
          },
          end: {
            line: 32,
            column: 3
          }
        },
        line: 27
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 34,
            column: 29
          },
          end: {
            line: 34,
            column: 30
          }
        },
        loc: {
          start: {
            line: 34,
            column: 35
          },
          end: {
            line: 47,
            column: 3
          }
        },
        line: 34
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 35,
            column: 64
          },
          end: {
            line: 35,
            column: 65
          }
        },
        loc: {
          start: {
            line: 35,
            column: 70
          },
          end: {
            line: 46,
            column: 5
          }
        },
        line: 35
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 49,
            column: 36
          },
          end: {
            line: 49,
            column: 37
          }
        },
        loc: {
          start: {
            line: 49,
            column: 42
          },
          end: {
            line: 60,
            column: 3
          }
        },
        line: 49
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 50,
            column: 63
          },
          end: {
            line: 50,
            column: 64
          }
        },
        loc: {
          start: {
            line: 50,
            column: 69
          },
          end: {
            line: 59,
            column: 5
          }
        },
        line: 50
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 53,
            column: 26
          },
          end: {
            line: 53,
            column: 27
          }
        },
        loc: {
          start: {
            line: 53,
            column: 41
          },
          end: {
            line: 55,
            column: 7
          }
        },
        line: 53
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 62,
            column: 36
          },
          end: {
            line: 62,
            column: 37
          }
        },
        loc: {
          start: {
            line: 62,
            column: 42
          },
          end: {
            line: 88,
            column: 3
          }
        },
        line: 62
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 63,
            column: 52
          },
          end: {
            line: 63,
            column: 53
          }
        },
        loc: {
          start: {
            line: 63,
            column: 58
          },
          end: {
            line: 72,
            column: 5
          }
        },
        line: 63
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 66,
            column: 26
          },
          end: {
            line: 66,
            column: 27
          }
        },
        loc: {
          start: {
            line: 66,
            column: 41
          },
          end: {
            line: 68,
            column: 7
          }
        },
        line: 66
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 74,
            column: 51
          },
          end: {
            line: 74,
            column: 52
          }
        },
        loc: {
          start: {
            line: 74,
            column: 57
          },
          end: {
            line: 87,
            column: 5
          }
        },
        line: 74
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 75,
            column: 13
          },
          end: {
            line: 75,
            column: 14
          }
        },
        loc: {
          start: {
            line: 75,
            column: 19
          },
          end: {
            line: 80,
            column: 7
          }
        },
        line: 75
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 76,
            column: 28
          },
          end: {
            line: 76,
            column: 29
          }
        },
        loc: {
          start: {
            line: 76,
            column: 43
          },
          end: {
            line: 78,
            column: 9
          }
        },
        line: 76
      },
      '13': {
        name: '(anonymous_13)',
        decl: {
          start: {
            line: 81,
            column: 13
          },
          end: {
            line: 81,
            column: 14
          }
        },
        loc: {
          start: {
            line: 81,
            column: 19
          },
          end: {
            line: 86,
            column: 7
          }
        },
        line: 81
      },
      '14': {
        name: '(anonymous_14)',
        decl: {
          start: {
            line: 82,
            column: 28
          },
          end: {
            line: 82,
            column: 29
          }
        },
        loc: {
          start: {
            line: 82,
            column: 43
          },
          end: {
            line: 84,
            column: 9
          }
        },
        line: 82
      },
      '15': {
        name: '(anonymous_15)',
        decl: {
          start: {
            line: 90,
            column: 39
          },
          end: {
            line: 90,
            column: 40
          }
        },
        loc: {
          start: {
            line: 90,
            column: 45
          },
          end: {
            line: 116,
            column: 3
          }
        },
        line: 90
      },
      '16': {
        name: '(anonymous_16)',
        decl: {
          start: {
            line: 91,
            column: 43
          },
          end: {
            line: 91,
            column: 44
          }
        },
        loc: {
          start: {
            line: 91,
            column: 49
          },
          end: {
            line: 100,
            column: 5
          }
        },
        line: 91
      },
      '17': {
        name: '(anonymous_17)',
        decl: {
          start: {
            line: 94,
            column: 29
          },
          end: {
            line: 94,
            column: 30
          }
        },
        loc: {
          start: {
            line: 94,
            column: 44
          },
          end: {
            line: 96,
            column: 7
          }
        },
        line: 94
      },
      '18': {
        name: '(anonymous_18)',
        decl: {
          start: {
            line: 102,
            column: 51
          },
          end: {
            line: 102,
            column: 52
          }
        },
        loc: {
          start: {
            line: 102,
            column: 57
          },
          end: {
            line: 115,
            column: 5
          }
        },
        line: 102
      },
      '19': {
        name: '(anonymous_19)',
        decl: {
          start: {
            line: 103,
            column: 13
          },
          end: {
            line: 103,
            column: 14
          }
        },
        loc: {
          start: {
            line: 103,
            column: 19
          },
          end: {
            line: 108,
            column: 7
          }
        },
        line: 103
      },
      '20': {
        name: '(anonymous_20)',
        decl: {
          start: {
            line: 104,
            column: 31
          },
          end: {
            line: 104,
            column: 32
          }
        },
        loc: {
          start: {
            line: 104,
            column: 46
          },
          end: {
            line: 106,
            column: 9
          }
        },
        line: 104
      },
      '21': {
        name: '(anonymous_21)',
        decl: {
          start: {
            line: 109,
            column: 13
          },
          end: {
            line: 109,
            column: 14
          }
        },
        loc: {
          start: {
            line: 109,
            column: 19
          },
          end: {
            line: 114,
            column: 7
          }
        },
        line: 109
      },
      '22': {
        name: '(anonymous_22)',
        decl: {
          start: {
            line: 110,
            column: 31
          },
          end: {
            line: 110,
            column: 32
          }
        },
        loc: {
          start: {
            line: 110,
            column: 46
          },
          end: {
            line: 112,
            column: 9
          }
        },
        line: 110
      }
    },
    branchMap: {},
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0,
      '47': 0,
      '48': 0,
      '49': 0,
      '50': 0,
      '51': 0,
      '52': 0,
      '53': 0,
      '54': 0,
      '55': 0,
      '56': 0,
      '57': 0,
      '58': 0,
      '59': 0,
      '60': 0,
      '61': 0,
      '62': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0
    },
    b: {},
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _temp;

function _load_temp() {
  return _temp = _interopRequireDefault(require('temp'));
}

var _nuclideUri;

function _load_nuclideUri() {
  return _nuclideUri = _interopRequireDefault(require('nuclide-commons/nuclideUri'));
}

var _projects;

function _load_projects() {
  return _projects = require('../projects');
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

cov_2hc1b1ocab.s[0]++;


describe('projects', () => {
  cov_2hc1b1ocab.f[0]++;

  let firstProjectPath = (cov_2hc1b1ocab.s[1]++, null);
  let otherProjectPath = (cov_2hc1b1ocab.s[2]++, null);

  cov_2hc1b1ocab.s[3]++;
  beforeEach(() => {
    cov_2hc1b1ocab.f[1]++;
    cov_2hc1b1ocab.s[4]++;

    (_temp || _load_temp()).default.track();
    // `atom.project.addPath` only works for paths that actually exist.
    cov_2hc1b1ocab.s[5]++;
    firstProjectPath = (_temp || _load_temp()).default.mkdirSync('firstProjectPath');
    cov_2hc1b1ocab.s[6]++;
    otherProjectPath = (_temp || _load_temp()).default.mkdirSync('otherProjectPath');
  });

  cov_2hc1b1ocab.s[7]++;
  describe('getFileForPath', () => {
    cov_2hc1b1ocab.f[2]++;
    cov_2hc1b1ocab.s[8]++;

    it('works for paths both above and below the project path', () => {
      cov_2hc1b1ocab.f[3]++;
      cov_2hc1b1ocab.s[9]++;

      atom.project.setPaths([firstProjectPath]);
      const path1 = (cov_2hc1b1ocab.s[10]++, (_nuclideUri || _load_nuclideUri()).default.join(firstProjectPath, '../test'));
      const file1 = (cov_2hc1b1ocab.s[11]++, (0, (_projects || _load_projects()).getFileForPath)(path1));
      cov_2hc1b1ocab.s[12]++;

      if (!(file1 != null)) {
        throw new Error('Invariant violation: "file1 != null"');
      }

      cov_2hc1b1ocab.s[13]++;

      expect(file1.getPath()).toBe(path1);

      const path2 = (cov_2hc1b1ocab.s[14]++, (_nuclideUri || _load_nuclideUri()).default.join(firstProjectPath, 'child/path'));
      const file2 = (cov_2hc1b1ocab.s[15]++, (0, (_projects || _load_projects()).getFileForPath)(path2));
      cov_2hc1b1ocab.s[16]++;

      if (!(file2 != null)) {
        throw new Error('Invariant violation: "file2 != null"');
      }

      cov_2hc1b1ocab.s[17]++;

      expect(file2.getPath()).toBe(path2);
    });
  });

  cov_2hc1b1ocab.s[18]++;
  describe('observeProjectPaths()', () => {
    cov_2hc1b1ocab.f[4]++;
    cov_2hc1b1ocab.s[19]++;

    it('observes existing projects and future added projects', () => {
      cov_2hc1b1ocab.f[5]++;

      const projectPaths = (cov_2hc1b1ocab.s[20]++, []);
      cov_2hc1b1ocab.s[21]++;
      atom.project.setPaths([firstProjectPath]);
      cov_2hc1b1ocab.s[22]++;
      (0, (_projects || _load_projects()).observeProjectPaths)(projectPath => {
        cov_2hc1b1ocab.f[6]++;
        cov_2hc1b1ocab.s[23]++;

        projectPaths.push(projectPath);
      });
      cov_2hc1b1ocab.s[24]++;
      expect(projectPaths).toEqual([firstProjectPath]);
      cov_2hc1b1ocab.s[25]++;
      atom.project.addPath(otherProjectPath);
      cov_2hc1b1ocab.s[26]++;
      expect(projectPaths).toEqual([firstProjectPath, otherProjectPath]);
    });
  });

  cov_2hc1b1ocab.s[27]++;
  describe('onDidAddProjectPath()', () => {
    cov_2hc1b1ocab.f[7]++;
    cov_2hc1b1ocab.s[28]++;

    it('listens only to newly added project paths', () => {
      cov_2hc1b1ocab.f[8]++;

      const addedProjectPaths = (cov_2hc1b1ocab.s[29]++, []);
      cov_2hc1b1ocab.s[30]++;
      atom.project.setPaths([firstProjectPath]);
      cov_2hc1b1ocab.s[31]++;
      (0, (_projects || _load_projects()).onDidAddProjectPath)(projectPath => {
        cov_2hc1b1ocab.f[9]++;
        cov_2hc1b1ocab.s[32]++;

        addedProjectPaths.push(projectPath);
      });
      cov_2hc1b1ocab.s[33]++;
      expect(addedProjectPaths.length).toBe(0);
      cov_2hc1b1ocab.s[34]++;
      atom.project.addPath(otherProjectPath);
      cov_2hc1b1ocab.s[35]++;
      expect(addedProjectPaths).toEqual([otherProjectPath]);
    });

    cov_2hc1b1ocab.s[36]++;
    it('throws when doing updates within updates', () => {
      cov_2hc1b1ocab.f[10]++;
      cov_2hc1b1ocab.s[37]++;

      expect(() => {
        cov_2hc1b1ocab.f[11]++;
        cov_2hc1b1ocab.s[38]++;

        (0, (_projects || _load_projects()).onDidAddProjectPath)(projectPath => {
          cov_2hc1b1ocab.f[12]++;
          cov_2hc1b1ocab.s[39]++;

          atom.project.addPath(otherProjectPath);
        });
        cov_2hc1b1ocab.s[40]++;
        atom.project.setPaths([firstProjectPath]);
      }).toThrow('Cannot update projects in the middle of an update');
      cov_2hc1b1ocab.s[41]++;
      expect(() => {
        cov_2hc1b1ocab.f[13]++;
        cov_2hc1b1ocab.s[42]++;

        (0, (_projects || _load_projects()).onDidAddProjectPath)(projectPath => {
          cov_2hc1b1ocab.f[14]++;
          cov_2hc1b1ocab.s[43]++;

          atom.project.removePath(firstProjectPath);
        });
        cov_2hc1b1ocab.s[44]++;
        atom.project.setPaths([firstProjectPath]);
      }).toThrow('Cannot update projects in the middle of an update');
    });
  });

  cov_2hc1b1ocab.s[45]++;
  describe('onDidRemoveProjectPath()', () => {
    cov_2hc1b1ocab.f[15]++;
    cov_2hc1b1ocab.s[46]++;

    it('listens to removed project paths', () => {
      cov_2hc1b1ocab.f[16]++;

      const removedProjectPaths = (cov_2hc1b1ocab.s[47]++, []);
      cov_2hc1b1ocab.s[48]++;
      atom.project.setPaths([firstProjectPath]);
      cov_2hc1b1ocab.s[49]++;
      (0, (_projects || _load_projects()).onDidRemoveProjectPath)(projectPath => {
        cov_2hc1b1ocab.f[17]++;
        cov_2hc1b1ocab.s[50]++;

        removedProjectPaths.push(projectPath);
      });
      cov_2hc1b1ocab.s[51]++;
      expect(removedProjectPaths.length).toBe(0);
      cov_2hc1b1ocab.s[52]++;
      atom.project.removePath(firstProjectPath);
      cov_2hc1b1ocab.s[53]++;
      expect(removedProjectPaths).toEqual([firstProjectPath]);
    });

    cov_2hc1b1ocab.s[54]++;
    it('throws when doing updates within updates', () => {
      cov_2hc1b1ocab.f[18]++;
      cov_2hc1b1ocab.s[55]++;

      expect(() => {
        cov_2hc1b1ocab.f[19]++;
        cov_2hc1b1ocab.s[56]++;

        (0, (_projects || _load_projects()).onDidRemoveProjectPath)(projectPath => {
          cov_2hc1b1ocab.f[20]++;
          cov_2hc1b1ocab.s[57]++;

          atom.project.addPath(otherProjectPath);
        });
        cov_2hc1b1ocab.s[58]++;
        atom.project.setPaths([firstProjectPath]);
      }).toThrow('Cannot update projects in the middle of an update');
      cov_2hc1b1ocab.s[59]++;
      expect(() => {
        cov_2hc1b1ocab.f[21]++;
        cov_2hc1b1ocab.s[60]++;

        (0, (_projects || _load_projects()).onDidRemoveProjectPath)(projectPath => {
          cov_2hc1b1ocab.f[22]++;
          cov_2hc1b1ocab.s[61]++;

          atom.project.removePath(firstProjectPath);
        });
        cov_2hc1b1ocab.s[62]++;
        atom.project.setPaths([firstProjectPath]);
      }).toThrow('Cannot update projects in the middle of an update');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzLXNwZWMuanMiXSwibmFtZXMiOlsiZGVzY3JpYmUiLCJmaXJzdFByb2plY3RQYXRoIiwib3RoZXJQcm9qZWN0UGF0aCIsImJlZm9yZUVhY2giLCJ0cmFjayIsIm1rZGlyU3luYyIsIml0IiwiYXRvbSIsInByb2plY3QiLCJzZXRQYXRocyIsInBhdGgxIiwiam9pbiIsImZpbGUxIiwiZXhwZWN0IiwiZ2V0UGF0aCIsInRvQmUiLCJwYXRoMiIsImZpbGUyIiwicHJvamVjdFBhdGhzIiwicHJvamVjdFBhdGgiLCJwdXNoIiwidG9FcXVhbCIsImFkZFBhdGgiLCJhZGRlZFByb2plY3RQYXRocyIsImxlbmd0aCIsInRvVGhyb3ciLCJyZW1vdmVQYXRoIiwicmVtb3ZlZFByb2plY3RQYXRocyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFhQTtBQUFBO0FBQUE7Ozs7QUFDQTtBQUFBO0FBQUE7Ozs7QUFDQTtBQUFBO0FBQUE7Ozs7QUFmQTs7Ozs7Ozs7Ozs7Ozs7O0FBc0JBQSxTQUFTLFVBQVQsRUFBcUIsTUFBTTtBQUFBOztBQUN6QixNQUFJQywyQ0FB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WixlQUFLQyxPQUFMLENBQWFjLE9BQWIsQ0FBcUJwQixnQkFBckI7QUFDRCxTQUZEO0FBRFc7QUFJWEssYUFBS0MsT0FBTCxDQUFhQyxRQUFiLENBQXNCLENBQUNSLGdCQUFELENBQXRCO0FBQ0QsT0FMRCxFQUtHd0IsT0FMSCxDQUtXLG1EQUxYO0FBRG1EO0FBT25EWixhQUFPLE1BQU07QUFBQTtBQUFBOztBQUNYLG9FQUF1Qk0sZUFBZTtBQUFBO0FBQUE7O0FBQ3BDWixlQUFLQyxPQUFMLENBQWFrQixVQUFiLENBQXdCekIsZ0JBQXhCO0FBQ0QsU0FGRDtBQURXO0FBSVhNLGFBQUtDLE9BQUwsQ0FBYUMsUUFBYixDQUFzQixDQUFDUixnQkFBRCxDQUF0QjtBQUNELE9BTEQsRUFLR3dCLE9BTEgsQ0FLVyxtREFMWDtBQU1ELEtBYkQ7QUFjRCxHQTFCRDtBQTJCRCxDQTlGRCIsImZpbGUiOiJwcm9qZWN0cy1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuaW1wb3J0IHRlbXAgZnJvbSAndGVtcCc7XG5pbXBvcnQgbnVjbGlkZVVyaSBmcm9tICdudWNsaWRlLWNvbW1vbnMvbnVjbGlkZVVyaSc7XG5pbXBvcnQge1xuICBnZXRGaWxlRm9yUGF0aCxcbiAgb2JzZXJ2ZVByb2plY3RQYXRocyxcbiAgb25EaWRBZGRQcm9qZWN0UGF0aCxcbiAgb25EaWRSZW1vdmVQcm9qZWN0UGF0aCxcbn0gZnJvbSAnLi4vcHJvamVjdHMnO1xuXG5kZXNjcmliZSgncHJvamVjdHMnLCAoKSA9PiB7XG4gIGxldCBmaXJzdFByb2plY3RQYXRoOiBzdHJpbmcgPSAobnVsbDogYW55KTtcbiAgbGV0IG90aGVyUHJvamVjdFBhdGg6IHN0cmluZyA9IChudWxsOiBhbnkpO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHRlbXAudHJhY2soKTtcbiAgICAvLyBgYXRvbS5wcm9qZWN0LmFkZFBhdGhgIG9ubHkgd29ya3MgZm9yIHBhdGhzIHRoYXQgYWN0dWFsbHkgZXhpc3QuXG4gICAgZmlyc3RQcm9qZWN0UGF0aCA9IHRlbXAubWtkaXJTeW5jKCdmaXJzdFByb2plY3RQYXRoJyk7XG4gICAgb3RoZXJQcm9qZWN0UGF0aCA9IHRlbXAubWtkaXJTeW5jKCdvdGhlclByb2plY3RQYXRoJyk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRGaWxlRm9yUGF0aCcsICgpID0+IHtcbiAgICBpdCgnd29ya3MgZm9yIHBhdGhzIGJvdGggYWJvdmUgYW5kIGJlbG93IHRoZSBwcm9qZWN0IHBhdGgnLCAoKSA9PiB7XG4gICAgICBhdG9tLnByb2plY3Quc2V0UGF0aHMoW2ZpcnN0UHJvamVjdFBhdGhdKTtcbiAgICAgIGNvbnN0IHBhdGgxID0gbnVjbGlkZVVyaS5qb2luKGZpcnN0UHJvamVjdFBhdGgsICcuLi90ZXN0Jyk7XG4gICAgICBjb25zdCBmaWxlMSA9IGdldEZpbGVGb3JQYXRoKHBhdGgxKTtcbiAgICAgIGludmFyaWFudChmaWxlMSAhPSBudWxsKTtcbiAgICAgIGV4cGVjdChmaWxlMS5nZXRQYXRoKCkpLnRvQmUocGF0aDEpO1xuXG4gICAgICBjb25zdCBwYXRoMiA9IG51Y2xpZGVVcmkuam9pbihmaXJzdFByb2plY3RQYXRoLCAnY2hpbGQvcGF0aCcpO1xuICAgICAgY29uc3QgZmlsZTIgPSBnZXRGaWxlRm9yUGF0aChwYXRoMik7XG4gICAgICBpbnZhcmlhbnQoZmlsZTIgIT0gbnVsbCk7XG4gICAgICBleHBlY3QoZmlsZTIuZ2V0UGF0aCgpKS50b0JlKHBhdGgyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ29ic2VydmVQcm9qZWN0UGF0aHMoKScsICgpID0+IHtcbiAgICBpdCgnb2JzZXJ2ZXMgZXhpc3RpbmcgcHJvamVjdHMgYW5kIGZ1dHVyZSBhZGRlZCBwcm9qZWN0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb2plY3RQYXRoczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgICAgYXRvbS5wcm9qZWN0LnNldFBhdGhzKFtmaXJzdFByb2plY3RQYXRoXSk7XG4gICAgICBvYnNlcnZlUHJvamVjdFBhdGhzKHByb2plY3RQYXRoID0+IHtcbiAgICAgICAgcHJvamVjdFBhdGhzLnB1c2gocHJvamVjdFBhdGgpO1xuICAgICAgfSk7XG4gICAgICBleHBlY3QocHJvamVjdFBhdGhzKS50b0VxdWFsKFtmaXJzdFByb2plY3RQYXRoXSk7XG4gICAgICBhdG9tLnByb2plY3QuYWRkUGF0aChvdGhlclByb2plY3RQYXRoKTtcbiAgICAgIGV4cGVjdChwcm9qZWN0UGF0aHMpLnRvRXF1YWwoW2ZpcnN0UHJvamVjdFBhdGgsIG90aGVyUHJvamVjdFBhdGhdKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ29uRGlkQWRkUHJvamVjdFBhdGgoKScsICgpID0+IHtcbiAgICBpdCgnbGlzdGVucyBvbmx5IHRvIG5ld2x5IGFkZGVkIHByb2plY3QgcGF0aHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhZGRlZFByb2plY3RQYXRoczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgICAgYXRvbS5wcm9qZWN0LnNldFBhdGhzKFtmaXJzdFByb2plY3RQYXRoXSk7XG4gICAgICBvbkRpZEFkZFByb2plY3RQYXRoKHByb2plY3RQYXRoID0+IHtcbiAgICAgICAgYWRkZWRQcm9qZWN0UGF0aHMucHVzaChwcm9qZWN0UGF0aCk7XG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChhZGRlZFByb2plY3RQYXRocy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgICBhdG9tLnByb2plY3QuYWRkUGF0aChvdGhlclByb2plY3RQYXRoKTtcbiAgICAgIGV4cGVjdChhZGRlZFByb2plY3RQYXRocykudG9FcXVhbChbb3RoZXJQcm9qZWN0UGF0aF0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Rocm93cyB3aGVuIGRvaW5nIHVwZGF0ZXMgd2l0aGluIHVwZGF0ZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBvbkRpZEFkZFByb2plY3RQYXRoKHByb2plY3RQYXRoID0+IHtcbiAgICAgICAgICBhdG9tLnByb2plY3QuYWRkUGF0aChvdGhlclByb2plY3RQYXRoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGF0b20ucHJvamVjdC5zZXRQYXRocyhbZmlyc3RQcm9qZWN0UGF0aF0pO1xuICAgICAgfSkudG9UaHJvdygnQ2Fubm90IHVwZGF0ZSBwcm9qZWN0cyBpbiB0aGUgbWlkZGxlIG9mIGFuIHVwZGF0ZScpO1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgb25EaWRBZGRQcm9qZWN0UGF0aChwcm9qZWN0UGF0aCA9PiB7XG4gICAgICAgICAgYXRvbS5wcm9qZWN0LnJlbW92ZVBhdGgoZmlyc3RQcm9qZWN0UGF0aCk7XG4gICAgICAgIH0pO1xuICAgICAgICBhdG9tLnByb2plY3Quc2V0UGF0aHMoW2ZpcnN0UHJvamVjdFBhdGhdKTtcbiAgICAgIH0pLnRvVGhyb3coJ0Nhbm5vdCB1cGRhdGUgcHJvamVjdHMgaW4gdGhlIG1pZGRsZSBvZiBhbiB1cGRhdGUnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ29uRGlkUmVtb3ZlUHJvamVjdFBhdGgoKScsICgpID0+IHtcbiAgICBpdCgnbGlzdGVucyB0byByZW1vdmVkIHByb2plY3QgcGF0aHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZW1vdmVkUHJvamVjdFBhdGhzOiBBcnJheTxzdHJpbmc+ID0gW107XG4gICAgICBhdG9tLnByb2plY3Quc2V0UGF0aHMoW2ZpcnN0UHJvamVjdFBhdGhdKTtcbiAgICAgIG9uRGlkUmVtb3ZlUHJvamVjdFBhdGgocHJvamVjdFBhdGggPT4ge1xuICAgICAgICByZW1vdmVkUHJvamVjdFBhdGhzLnB1c2gocHJvamVjdFBhdGgpO1xuICAgICAgfSk7XG4gICAgICBleHBlY3QocmVtb3ZlZFByb2plY3RQYXRocy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgICBhdG9tLnByb2plY3QucmVtb3ZlUGF0aChmaXJzdFByb2plY3RQYXRoKTtcbiAgICAgIGV4cGVjdChyZW1vdmVkUHJvamVjdFBhdGhzKS50b0VxdWFsKFtmaXJzdFByb2plY3RQYXRoXSk7XG4gICAgfSk7XG5cbiAgICBpdCgndGhyb3dzIHdoZW4gZG9pbmcgdXBkYXRlcyB3aXRoaW4gdXBkYXRlcycsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG9uRGlkUmVtb3ZlUHJvamVjdFBhdGgocHJvamVjdFBhdGggPT4ge1xuICAgICAgICAgIGF0b20ucHJvamVjdC5hZGRQYXRoKG90aGVyUHJvamVjdFBhdGgpO1xuICAgICAgICB9KTtcbiAgICAgICAgYXRvbS5wcm9qZWN0LnNldFBhdGhzKFtmaXJzdFByb2plY3RQYXRoXSk7XG4gICAgICB9KS50b1Rocm93KCdDYW5ub3QgdXBkYXRlIHByb2plY3RzIGluIHRoZSBtaWRkbGUgb2YgYW4gdXBkYXRlJyk7XG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBvbkRpZFJlbW92ZVByb2plY3RQYXRoKHByb2plY3RQYXRoID0+IHtcbiAgICAgICAgICBhdG9tLnByb2plY3QucmVtb3ZlUGF0aChmaXJzdFByb2plY3RQYXRoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGF0b20ucHJvamVjdC5zZXRQYXRocyhbZmlyc3RQcm9qZWN0UGF0aF0pO1xuICAgICAgfSkudG9UaHJvdygnQ2Fubm90IHVwZGF0ZSBwcm9qZWN0cyBpbiB0aGUgbWlkZGxlIG9mIGFuIHVwZGF0ZScpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19