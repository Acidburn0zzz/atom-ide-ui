'use strict';

var cov_1kd8fhk0s7 = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-atom/spec/FeatureLoader-spec.js',
      hash = '8bf775a2b697ceee7e228b5541db61480c3ef9ed',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-atom/spec/FeatureLoader-spec.js',
    statementMap: {
      '0': {
        start: {
          line: 20,
          column: 28
        },
        end: {
          line: 20,
          column: 79
        }
      },
      '1': {
        start: {
          line: 21,
          column: 19
        },
        end: {
          line: 23,
          column: 1
        }
      },
      '2': {
        start: {
          line: 24,
          column: 20
        },
        end: {
          line: 24,
          column: 35
        }
      },
      '3': {
        start: {
          line: 26,
          column: 25
        },
        end: {
          line: 26,
          column: 73
        }
      },
      '4': {
        start: {
          line: 27,
          column: 16
        },
        end: {
          line: 29,
          column: 1
        }
      },
      '5': {
        start: {
          line: 31,
          column: 0
        },
        end: {
          line: 120,
          column: 3
        }
      },
      '6': {
        start: {
          line: 33,
          column: 2
        },
        end: {
          line: 44,
          column: 5
        }
      },
      '7': {
        start: {
          line: 34,
          column: 4
        },
        end: {
          line: 42,
          column: 7
        }
      },
      '8': {
        start: {
          line: 43,
          column: 4
        },
        end: {
          line: 43,
          column: 48
        }
      },
      '9': {
        start: {
          line: 46,
          column: 2
        },
        end: {
          line: 75,
          column: 5
        }
      },
      '10': {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 52,
          column: 7
        }
      },
      '11': {
        start: {
          line: 48,
          column: 6
        },
        end: {
          line: 48,
          column: 42
        }
      },
      '12': {
        start: {
          line: 49,
          column: 6
        },
        end: {
          line: 49,
          column: 70
        }
      },
      '13': {
        start: {
          line: 50,
          column: 6
        },
        end: {
          line: 50,
          column: 20
        }
      },
      '14': {
        start: {
          line: 51,
          column: 6
        },
        end: {
          line: 51,
          column: 75
        }
      },
      '15': {
        start: {
          line: 54,
          column: 4
        },
        end: {
          line: 60,
          column: 7
        }
      },
      '16': {
        start: {
          line: 55,
          column: 6
        },
        end: {
          line: 59,
          column: 8
        }
      },
      '17': {
        start: {
          line: 62,
          column: 4
        },
        end: {
          line: 66,
          column: 7
        }
      },
      '18': {
        start: {
          line: 63,
          column: 6
        },
        end: {
          line: 65,
          column: 8
        }
      },
      '19': {
        start: {
          line: 68,
          column: 4
        },
        end: {
          line: 74,
          column: 7
        }
      },
      '20': {
        start: {
          line: 69,
          column: 6
        },
        end: {
          line: 73,
          column: 9
        }
      },
      '21': {
        start: {
          line: 70,
          column: 8
        },
        end: {
          line: 72,
          column: 10
        }
      },
      '22': {
        start: {
          line: 77,
          column: 2
        },
        end: {
          line: 92,
          column: 5
        }
      },
      '23': {
        start: {
          line: 78,
          column: 4
        },
        end: {
          line: 91,
          column: 7
        }
      },
      '24': {
        start: {
          line: 79,
          column: 6
        },
        end: {
          line: 79,
          column: 46
        }
      },
      '25': {
        start: {
          line: 81,
          column: 6
        },
        end: {
          line: 81,
          column: 20
        }
      },
      '26': {
        start: {
          line: 82,
          column: 6
        },
        end: {
          line: 82,
          column: 70
        }
      },
      '27': {
        start: {
          line: 83,
          column: 6
        },
        end: {
          line: 83,
          column: 75
        }
      },
      '28': {
        start: {
          line: 84,
          column: 6
        },
        end: {
          line: 84,
          column: 24
        }
      },
      '29': {
        start: {
          line: 86,
          column: 6
        },
        end: {
          line: 90,
          column: 9
        }
      },
      '30': {
        start: {
          line: 87,
          column: 8
        },
        end: {
          line: 89,
          column: 10
        }
      },
      '31': {
        start: {
          line: 94,
          column: 2
        },
        end: {
          line: 119,
          column: 5
        }
      },
      '32': {
        start: {
          line: 95,
          column: 4
        },
        end: {
          line: 118,
          column: 7
        }
      },
      '33': {
        start: {
          line: 96,
          column: 6
        },
        end: {
          line: 96,
          column: 46
        }
      },
      '34': {
        start: {
          line: 97,
          column: 6
        },
        end: {
          line: 97,
          column: 48
        }
      },
      '35': {
        start: {
          line: 99,
          column: 6
        },
        end: {
          line: 99,
          column: 20
        }
      },
      '36': {
        start: {
          line: 100,
          column: 6
        },
        end: {
          line: 100,
          column: 70
        }
      },
      '37': {
        start: {
          line: 101,
          column: 6
        },
        end: {
          line: 101,
          column: 75
        }
      },
      '38': {
        start: {
          line: 102,
          column: 6
        },
        end: {
          line: 102,
          column: 24
        }
      },
      '39': {
        start: {
          line: 104,
          column: 6
        },
        end: {
          line: 106,
          column: 8
        }
      },
      '40': {
        start: {
          line: 108,
          column: 6
        },
        end: {
          line: 108,
          column: 26
        }
      },
      '41': {
        start: {
          line: 109,
          column: 6
        },
        end: {
          line: 112,
          column: 8
        }
      },
      '42': {
        start: {
          line: 114,
          column: 6
        },
        end: {
          line: 114,
          column: 24
        }
      },
      '43': {
        start: {
          line: 115,
          column: 6
        },
        end: {
          line: 117,
          column: 8
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 31,
            column: 26
          },
          end: {
            line: 31,
            column: 27
          }
        },
        loc: {
          start: {
            line: 31,
            column: 32
          },
          end: {
            line: 120,
            column: 1
          }
        },
        line: 31
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 33,
            column: 13
          },
          end: {
            line: 33,
            column: 14
          }
        },
        loc: {
          start: {
            line: 33,
            column: 19
          },
          end: {
            line: 44,
            column: 3
          }
        },
        line: 33
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 46,
            column: 19
          },
          end: {
            line: 46,
            column: 20
          }
        },
        loc: {
          start: {
            line: 46,
            column: 25
          },
          end: {
            line: 75,
            column: 3
          }
        },
        line: 46
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 47,
            column: 15
          },
          end: {
            line: 47,
            column: 16
          }
        },
        loc: {
          start: {
            line: 47,
            column: 21
          },
          end: {
            line: 52,
            column: 5
          }
        },
        line: 47
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 54,
            column: 70
          },
          end: {
            line: 54,
            column: 71
          }
        },
        loc: {
          start: {
            line: 54,
            column: 76
          },
          end: {
            line: 60,
            column: 5
          }
        },
        line: 54
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 62,
            column: 80
          },
          end: {
            line: 62,
            column: 81
          }
        },
        loc: {
          start: {
            line: 62,
            column: 86
          },
          end: {
            line: 66,
            column: 5
          }
        },
        line: 62
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 68,
            column: 64
          },
          end: {
            line: 68,
            column: 65
          }
        },
        loc: {
          start: {
            line: 68,
            column: 70
          },
          end: {
            line: 74,
            column: 5
          }
        },
        line: 68
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 69,
            column: 11
          },
          end: {
            line: 69,
            column: 12
          }
        },
        loc: {
          start: {
            line: 69,
            column: 17
          },
          end: {
            line: 73,
            column: 7
          }
        },
        line: 69
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 77,
            column: 23
          },
          end: {
            line: 77,
            column: 24
          }
        },
        loc: {
          start: {
            line: 77,
            column: 29
          },
          end: {
            line: 92,
            column: 3
          }
        },
        line: 77
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 78,
            column: 62
          },
          end: {
            line: 78,
            column: 63
          }
        },
        loc: {
          start: {
            line: 78,
            column: 68
          },
          end: {
            line: 91,
            column: 5
          }
        },
        line: 78
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 86,
            column: 11
          },
          end: {
            line: 86,
            column: 12
          }
        },
        loc: {
          start: {
            line: 86,
            column: 17
          },
          end: {
            line: 90,
            column: 7
          }
        },
        line: 86
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 94,
            column: 62
          },
          end: {
            line: 94,
            column: 63
          }
        },
        loc: {
          start: {
            line: 94,
            column: 68
          },
          end: {
            line: 119,
            column: 3
          }
        },
        line: 94
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 95,
            column: 64
          },
          end: {
            line: 95,
            column: 65
          }
        },
        loc: {
          start: {
            line: 95,
            column: 70
          },
          end: {
            line: 118,
            column: 5
          }
        },
        line: 95
      }
    },
    branchMap: {},
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0
    },
    b: {},
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _idx;

function _load_idx() {
  return _idx = _interopRequireDefault(require('idx'));
}

var _fs = _interopRequireDefault(require('fs'));

var _path = _interopRequireDefault(require('path'));

var _FeatureLoader;

function _load_FeatureLoader() {
  return _FeatureLoader = _interopRequireDefault(require('../FeatureLoader'));
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// eslint-disable-next-line rulesdir/prefer-nuclide-uri
/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

const FEATURE_PACKAGE_DIR = (cov_1kd8fhk0s7.s[0]++, _path.default.join(__dirname, 'fixtures', 'feature-package'));
const featurePkg = (cov_1kd8fhk0s7.s[1]++, JSON.parse(_fs.default.readFileSync(_path.default.join(FEATURE_PACKAGE_DIR, 'package.json')).toString()));
const featureName = (cov_1kd8fhk0s7.s[2]++, featurePkg.name);

const ROOT_PACKAGE_DIR = (cov_1kd8fhk0s7.s[3]++, _path.default.join(__dirname, 'fixtures', 'root-package'));
const rootPkg = (cov_1kd8fhk0s7.s[4]++, JSON.parse(_fs.default.readFileSync(_path.default.join(ROOT_PACKAGE_DIR, 'package.json')).toString()));

cov_1kd8fhk0s7.s[5]++;
describe('FeatureLoader', () => {
  cov_1kd8fhk0s7.f[0]++;

  let loader;
  cov_1kd8fhk0s7.s[6]++;
  beforeEach(() => {
    cov_1kd8fhk0s7.f[1]++;
    cov_1kd8fhk0s7.s[7]++;

    loader = new (_FeatureLoader || _load_FeatureLoader()).default({
      pkgName: rootPkg.name,
      features: [{
        dirname: FEATURE_PACKAGE_DIR,
        pkg: featurePkg
      }]
    });
    cov_1kd8fhk0s7.s[8]++;
    atom.packages.loadPackage(ROOT_PACKAGE_DIR);
  });

  cov_1kd8fhk0s7.s[9]++;
  describe('load', () => {
    cov_1kd8fhk0s7.f[2]++;
    cov_1kd8fhk0s7.s[10]++;

    beforeEach(() => {
      cov_1kd8fhk0s7.f[3]++;
      cov_1kd8fhk0s7.s[11]++;

      spyOn(atom.packages, 'loadPackage');
      cov_1kd8fhk0s7.s[12]++;
      atom.config.set(`${rootPkg.name}.use.${featurePkg.name}`, true);
      cov_1kd8fhk0s7.s[13]++;
      loader.load();
      cov_1kd8fhk0s7.s[14]++;
      atom.packages.emitter.emit('did-load-package', { name: rootPkg.name });
    });

    cov_1kd8fhk0s7.s[15]++;
    it('sets a description including provided and consumed services', () => {
      var _ref, _ref2, _ref3, _ref4;

      cov_1kd8fhk0s7.f[4]++;
      cov_1kd8fhk0s7.s[16]++;

      expect((_ref = loader.getConfig()) != null ? (_ref2 = _ref.use) != null ? (_ref3 = _ref2.properties) != null ? (_ref4 = _ref3[featureName]) != null ? _ref4.description : _ref4 : _ref3 : _ref2 : _ref).toEqual('Hyperclick UI<br/>**Provides:** _hyperclick.observeTextEditor_<br/>**Consumes:** _hyperclick_');
    });

    cov_1kd8fhk0s7.s[17]++;
    it("merges the feature config into the passed config's feature properties", () => {
      var _ref5, _ref6;

      cov_1kd8fhk0s7.f[5]++;
      cov_1kd8fhk0s7.s[18]++;

      expect((_ref5 = loader.getConfig()) != null ? (_ref6 = _ref5[featureName]) != null ? _ref6.properties : _ref6 : _ref5).toEqual(featurePkg.atomConfig);
    });

    cov_1kd8fhk0s7.s[19]++;
    it('loads the feature package when the root package loads', () => {
      cov_1kd8fhk0s7.f[6]++;
      cov_1kd8fhk0s7.s[20]++;

      runs(() => {
        cov_1kd8fhk0s7.f[7]++;
        cov_1kd8fhk0s7.s[21]++;

        expect(atom.packages.loadPackage).toHaveBeenCalledWith(FEATURE_PACKAGE_DIR);
      });
    });
  });

  cov_1kd8fhk0s7.s[22]++;
  describe('activate', () => {
    cov_1kd8fhk0s7.f[8]++;
    cov_1kd8fhk0s7.s[23]++;

    it('activates the feature package right away if enabled', () => {
      cov_1kd8fhk0s7.f[9]++;
      cov_1kd8fhk0s7.s[24]++;

      spyOn(atom.packages, 'activatePackage');

      cov_1kd8fhk0s7.s[25]++;
      loader.load();
      cov_1kd8fhk0s7.s[26]++;
      atom.config.set(`${rootPkg.name}.use.${featurePkg.name}`, true);
      cov_1kd8fhk0s7.s[27]++;
      atom.packages.emitter.emit('did-load-package', { name: rootPkg.name });
      cov_1kd8fhk0s7.s[28]++;
      loader.activate();

      cov_1kd8fhk0s7.s[29]++;
      runs(() => {
        cov_1kd8fhk0s7.f[10]++;
        cov_1kd8fhk0s7.s[30]++;

        expect(atom.packages.activatePackage).toHaveBeenCalledWith(FEATURE_PACKAGE_DIR);
      });
    });
  });

  cov_1kd8fhk0s7.s[31]++;
  describe('activating, deactivating, then activating again', () => {
    cov_1kd8fhk0s7.f[11]++;
    cov_1kd8fhk0s7.s[32]++;

    it('actives, deactivates, then activates feature packages', () => {
      cov_1kd8fhk0s7.f[12]++;
      cov_1kd8fhk0s7.s[33]++;

      spyOn(atom.packages, 'activatePackage');
      cov_1kd8fhk0s7.s[34]++;
      spyOn(atom.packages, 'deactivatePackage');

      cov_1kd8fhk0s7.s[35]++;
      loader.load();
      cov_1kd8fhk0s7.s[36]++;
      atom.config.set(`${rootPkg.name}.use.${featurePkg.name}`, true);
      cov_1kd8fhk0s7.s[37]++;
      atom.packages.emitter.emit('did-load-package', { name: rootPkg.name });
      cov_1kd8fhk0s7.s[38]++;
      loader.activate();

      cov_1kd8fhk0s7.s[39]++;
      expect(atom.packages.activatePackage).toHaveBeenCalledWith(FEATURE_PACKAGE_DIR);

      cov_1kd8fhk0s7.s[40]++;
      loader.deactivate();
      cov_1kd8fhk0s7.s[41]++;
      expect(atom.packages.deactivatePackage).toHaveBeenCalledWith(featurePkg.name, true);

      cov_1kd8fhk0s7.s[42]++;
      loader.activate();
      cov_1kd8fhk0s7.s[43]++;
      expect(atom.packages.activatePackage).toHaveBeenCalledWith(FEATURE_PACKAGE_DIR);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZlYXR1cmVMb2FkZXItc3BlYy5qcyJdLCJuYW1lcyI6WyJGRUFUVVJFX1BBQ0tBR0VfRElSIiwiam9pbiIsIl9fZGlybmFtZSIsImZlYXR1cmVQa2ciLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJ0b1N0cmluZyIsImZlYXR1cmVOYW1lIiwibmFtZSIsIlJPT1RfUEFDS0FHRV9ESVIiLCJyb290UGtnIiwiZGVzY3JpYmUiLCJsb2FkZXIiLCJiZWZvcmVFYWNoIiwicGtnTmFtZSIsImZlYXR1cmVzIiwiZGlybmFtZSIsInBrZyIsImF0b20iLCJwYWNrYWdlcyIsImxvYWRQYWNrYWdlIiwic3B5T24iLCJjb25maWciLCJzZXQiLCJsb2FkIiwiZW1pdHRlciIsImVtaXQiLCJpdCIsImV4cGVjdCIsImdldENvbmZpZyIsInVzZSIsInByb3BlcnRpZXMiLCJkZXNjcmlwdGlvbiIsInRvRXF1YWwiLCJhdG9tQ29uZmlnIiwicnVucyIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwiYWN0aXZhdGUiLCJhY3RpdmF0ZVBhY2thZ2UiLCJkZWFjdGl2YXRlIiwiZGVhY3RpdmF0ZVBhY2thZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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Z0U7QUFFaEVFLFlBQU1ILEtBQUtDLFFBQVgsRUFBcUIsbUJBQXJCOztBQUZnRTtBQUloRVAsYUFBT1ksSUFBUDtBQUpnRTtBQUtoRU4sV0FBS0ksTUFBTCxDQUFZQyxHQUFaLENBQWlCLEdBQUViLFFBQVFGLElBQUssUUFBT04sV0FBV00sSUFBSyxFQUF2RCxFQUEwRCxJQUExRDtBQUxnRTtBQU1oRVUsV0FBS0MsUUFBTCxDQUFjTSxPQUFkLENBQXNCQyxJQUF0QixDQUEyQixrQkFBM0IsRUFBK0MsRUFBQ2xCLE1BQU1FLFFBQVFGLElBQWYsRUFBL0M7QUFOZ0U7QUFPaEVJLGFBQU95QixRQUFQOztBQVBnRTtBQVNoRVQsYUFBT1YsS0FBS0MsUUFBTCxDQUFjbUIsZUFBckIsRUFBc0NGLG9CQUF0QyxDQUNFckMsbUJBREY7O0FBVGdFO0FBYWhFYSxhQUFPMkIsVUFBUDtBQWJnRTtBQWNoRVgsYUFBT1YsS0FBS0MsUUFBTCxDQUFjcUIsaUJBQXJCLEVBQXdDSixvQkFBeEMsQ0FDRWxDLFdBQVdNLElBRGIsRUFFRSxJQUZGOztBQWRnRTtBQW1CaEVJLGFBQU95QixRQUFQO0FBbkJnRTtBQW9CaEVULGFBQU9WLEtBQUtDLFFBQUwsQ0FBY21CLGVBQXJCLEVBQXNDRixvQkFBdEMsQ0FDRXJDLG1CQURGO0FBR0QsS0F2QkQ7QUF3QkQsR0F6QkQ7QUEwQkQsQ0F6RkQiLCJmaWxlIjoiRmVhdHVyZUxvYWRlci1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IGlkeCBmcm9tICdpZHgnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBydWxlc2Rpci9wcmVmZXItbnVjbGlkZS11cmlcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5pbXBvcnQgRmVhdHVyZUxvYWRlciBmcm9tICcuLi9GZWF0dXJlTG9hZGVyJztcblxuY29uc3QgRkVBVFVSRV9QQUNLQUdFX0RJUiA9IHBhdGguam9pbihfX2Rpcm5hbWUsICdmaXh0dXJlcycsICdmZWF0dXJlLXBhY2thZ2UnKTtcbmNvbnN0IGZlYXR1cmVQa2cgPSBKU09OLnBhcnNlKFxuICBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKEZFQVRVUkVfUEFDS0FHRV9ESVIsICdwYWNrYWdlLmpzb24nKSkudG9TdHJpbmcoKSxcbik7XG5jb25zdCBmZWF0dXJlTmFtZSA9IGZlYXR1cmVQa2cubmFtZTtcblxuY29uc3QgUk9PVF9QQUNLQUdFX0RJUiA9IHBhdGguam9pbihfX2Rpcm5hbWUsICdmaXh0dXJlcycsICdyb290LXBhY2thZ2UnKTtcbmNvbnN0IHJvb3RQa2cgPSBKU09OLnBhcnNlKFxuICBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKFJPT1RfUEFDS0FHRV9ESVIsICdwYWNrYWdlLmpzb24nKSkudG9TdHJpbmcoKSxcbik7XG5cbmRlc2NyaWJlKCdGZWF0dXJlTG9hZGVyJywgKCkgPT4ge1xuICBsZXQgbG9hZGVyO1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBsb2FkZXIgPSBuZXcgRmVhdHVyZUxvYWRlcih7XG4gICAgICBwa2dOYW1lOiByb290UGtnLm5hbWUsXG4gICAgICBmZWF0dXJlczogW1xuICAgICAgICB7XG4gICAgICAgICAgZGlybmFtZTogRkVBVFVSRV9QQUNLQUdFX0RJUixcbiAgICAgICAgICBwa2c6IGZlYXR1cmVQa2csXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pO1xuICAgIGF0b20ucGFja2FnZXMubG9hZFBhY2thZ2UoUk9PVF9QQUNLQUdFX0RJUik7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdsb2FkJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgc3B5T24oYXRvbS5wYWNrYWdlcywgJ2xvYWRQYWNrYWdlJyk7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoYCR7cm9vdFBrZy5uYW1lfS51c2UuJHtmZWF0dXJlUGtnLm5hbWV9YCwgdHJ1ZSk7XG4gICAgICBsb2FkZXIubG9hZCgpO1xuICAgICAgYXRvbS5wYWNrYWdlcy5lbWl0dGVyLmVtaXQoJ2RpZC1sb2FkLXBhY2thZ2UnLCB7bmFtZTogcm9vdFBrZy5uYW1lfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2V0cyBhIGRlc2NyaXB0aW9uIGluY2x1ZGluZyBwcm92aWRlZCBhbmQgY29uc3VtZWQgc2VydmljZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoXG4gICAgICAgIGlkeChsb2FkZXIuZ2V0Q29uZmlnKCksIF8gPT4gXy51c2UucHJvcGVydGllc1tmZWF0dXJlTmFtZV0uZGVzY3JpcHRpb24pLFxuICAgICAgKS50b0VxdWFsKFxuICAgICAgICAnSHlwZXJjbGljayBVSTxici8+KipQcm92aWRlczoqKiBfaHlwZXJjbGljay5vYnNlcnZlVGV4dEVkaXRvcl88YnIvPioqQ29uc3VtZXM6KiogX2h5cGVyY2xpY2tfJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdChcIm1lcmdlcyB0aGUgZmVhdHVyZSBjb25maWcgaW50byB0aGUgcGFzc2VkIGNvbmZpZydzIGZlYXR1cmUgcHJvcGVydGllc1wiLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaWR4KGxvYWRlci5nZXRDb25maWcoKSwgXyA9PiBfW2ZlYXR1cmVOYW1lXS5wcm9wZXJ0aWVzKSkudG9FcXVhbChcbiAgICAgICAgZmVhdHVyZVBrZy5hdG9tQ29uZmlnLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdsb2FkcyB0aGUgZmVhdHVyZSBwYWNrYWdlIHdoZW4gdGhlIHJvb3QgcGFja2FnZSBsb2FkcycsICgpID0+IHtcbiAgICAgIHJ1bnMoKCkgPT4ge1xuICAgICAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5sb2FkUGFja2FnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgRkVBVFVSRV9QQUNLQUdFX0RJUixcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYWN0aXZhdGUnLCAoKSA9PiB7XG4gICAgaXQoJ2FjdGl2YXRlcyB0aGUgZmVhdHVyZSBwYWNrYWdlIHJpZ2h0IGF3YXkgaWYgZW5hYmxlZCcsICgpID0+IHtcbiAgICAgIHNweU9uKGF0b20ucGFja2FnZXMsICdhY3RpdmF0ZVBhY2thZ2UnKTtcblxuICAgICAgbG9hZGVyLmxvYWQoKTtcbiAgICAgIGF0b20uY29uZmlnLnNldChgJHtyb290UGtnLm5hbWV9LnVzZS4ke2ZlYXR1cmVQa2cubmFtZX1gLCB0cnVlKTtcbiAgICAgIGF0b20ucGFja2FnZXMuZW1pdHRlci5lbWl0KCdkaWQtbG9hZC1wYWNrYWdlJywge25hbWU6IHJvb3RQa2cubmFtZX0pO1xuICAgICAgbG9hZGVyLmFjdGl2YXRlKCk7XG5cbiAgICAgIHJ1bnMoKCkgPT4ge1xuICAgICAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5hY3RpdmF0ZVBhY2thZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIEZFQVRVUkVfUEFDS0FHRV9ESVIsXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2FjdGl2YXRpbmcsIGRlYWN0aXZhdGluZywgdGhlbiBhY3RpdmF0aW5nIGFnYWluJywgKCkgPT4ge1xuICAgIGl0KCdhY3RpdmVzLCBkZWFjdGl2YXRlcywgdGhlbiBhY3RpdmF0ZXMgZmVhdHVyZSBwYWNrYWdlcycsICgpID0+IHtcbiAgICAgIHNweU9uKGF0b20ucGFja2FnZXMsICdhY3RpdmF0ZVBhY2thZ2UnKTtcbiAgICAgIHNweU9uKGF0b20ucGFja2FnZXMsICdkZWFjdGl2YXRlUGFja2FnZScpO1xuXG4gICAgICBsb2FkZXIubG9hZCgpO1xuICAgICAgYXRvbS5jb25maWcuc2V0KGAke3Jvb3RQa2cubmFtZX0udXNlLiR7ZmVhdHVyZVBrZy5uYW1lfWAsIHRydWUpO1xuICAgICAgYXRvbS5wYWNrYWdlcy5lbWl0dGVyLmVtaXQoJ2RpZC1sb2FkLXBhY2thZ2UnLCB7bmFtZTogcm9vdFBrZy5uYW1lfSk7XG4gICAgICBsb2FkZXIuYWN0aXZhdGUoKTtcblxuICAgICAgZXhwZWN0KGF0b20ucGFja2FnZXMuYWN0aXZhdGVQYWNrYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgRkVBVFVSRV9QQUNLQUdFX0RJUixcbiAgICAgICk7XG5cbiAgICAgIGxvYWRlci5kZWFjdGl2YXRlKCk7XG4gICAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5kZWFjdGl2YXRlUGFja2FnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGZlYXR1cmVQa2cubmFtZSxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICk7XG5cbiAgICAgIGxvYWRlci5hY3RpdmF0ZSgpO1xuICAgICAgZXhwZWN0KGF0b20ucGFja2FnZXMuYWN0aXZhdGVQYWNrYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgRkVBVFVSRV9QQUNLQUdFX0RJUixcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=