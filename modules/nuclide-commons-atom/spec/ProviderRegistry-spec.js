'use strict';

var cov_17zfov6qso = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-atom/spec/ProviderRegistry-spec.js',
      hash = '2dd9c28745780202e17f57458de2cc736b63a8e5',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-atom/spec/ProviderRegistry-spec.js',
    statementMap: {
      '0': {
        start: {
          line: 17,
          column: 0
        },
        end: {
          line: 83,
          column: 3
        }
      },
      '1': {
        start: {
          line: 18,
          column: 54
        },
        end: {
          line: 18,
          column: 63
        }
      },
      '2': {
        start: {
          line: 22,
          column: 2
        },
        end: {
          line: 34,
          column: 5
        }
      },
      '3': {
        start: {
          line: 23,
          column: 4
        },
        end: {
          line: 23,
          column: 46
        }
      },
      '4': {
        start: {
          line: 24,
          column: 4
        },
        end: {
          line: 27,
          column: 6
        }
      },
      '5': {
        start: {
          line: 28,
          column: 4
        },
        end: {
          line: 31,
          column: 6
        }
      },
      '6': {
        start: {
          line: 32,
          column: 4
        },
        end: {
          line: 32,
          column: 44
        }
      },
      '7': {
        start: {
          line: 33,
          column: 4
        },
        end: {
          line: 33,
          column: 44
        }
      },
      '8': {
        start: {
          line: 36,
          column: 2
        },
        end: {
          line: 40,
          column: 5
        }
      },
      '9': {
        start: {
          line: 37,
          column: 4
        },
        end: {
          line: 37,
          column: 65
        }
      },
      '10': {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 38,
          column: 65
        }
      },
      '11': {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 39,
          column: 65
        }
      },
      '12': {
        start: {
          line: 42,
          column: 2
        },
        end: {
          line: 51,
          column: 5
        }
      },
      '13': {
        start: {
          line: 43,
          column: 24
        },
        end: {
          line: 49,
          column: 5
        }
      },
      '14': {
        start: {
          line: 45,
          column: 8
        },
        end: {
          line: 47,
          column: 10
        }
      },
      '15': {
        start: {
          line: 50,
          column: 4
        },
        end: {
          line: 50,
          column: 74
        }
      },
      '16': {
        start: {
          line: 53,
          column: 2
        },
        end: {
          line: 59,
          column: 5
        }
      },
      '17': {
        start: {
          line: 54,
          column: 22
        },
        end: {
          line: 56,
          column: 5
        }
      },
      '18': {
        start: {
          line: 57,
          column: 4
        },
        end: {
          line: 57,
          column: 44
        }
      },
      '19': {
        start: {
          line: 58,
          column: 4
        },
        end: {
          line: 58,
          column: 66
        }
      },
      '20': {
        start: {
          line: 61,
          column: 2
        },
        end: {
          line: 72,
          column: 5
        }
      },
      '21': {
        start: {
          line: 62,
          column: 24
        },
        end: {
          line: 68,
          column: 5
        }
      },
      '22': {
        start: {
          line: 64,
          column: 8
        },
        end: {
          line: 66,
          column: 10
        }
      },
      '23': {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 71,
          column: 38
        }
      },
      '24': {
        start: {
          line: 74,
          column: 2
        },
        end: {
          line: 76,
          column: 5
        }
      },
      '25': {
        start: {
          line: 75,
          column: 4
        },
        end: {
          line: 75,
          column: 59
        }
      },
      '26': {
        start: {
          line: 78,
          column: 2
        },
        end: {
          line: 82,
          column: 5
        }
      },
      '27': {
        start: {
          line: 79,
          column: 4
        },
        end: {
          line: 79,
          column: 47
        }
      },
      '28': {
        start: {
          line: 80,
          column: 4
        },
        end: {
          line: 80,
          column: 60
        }
      },
      '29': {
        start: {
          line: 81,
          column: 4
        },
        end: {
          line: 81,
          column: 65
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 17,
            column: 29
          },
          end: {
            line: 17,
            column: 30
          }
        },
        loc: {
          start: {
            line: 17,
            column: 35
          },
          end: {
            line: 83,
            column: 1
          }
        },
        line: 17
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 22,
            column: 13
          },
          end: {
            line: 22,
            column: 14
          }
        },
        loc: {
          start: {
            line: 22,
            column: 19
          },
          end: {
            line: 34,
            column: 3
          }
        },
        line: 22
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 36,
            column: 52
          },
          end: {
            line: 36,
            column: 53
          }
        },
        loc: {
          start: {
            line: 36,
            column: 58
          },
          end: {
            line: 40,
            column: 3
          }
        },
        line: 36
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 42,
            column: 49
          },
          end: {
            line: 42,
            column: 50
          }
        },
        loc: {
          start: {
            line: 42,
            column: 55
          },
          end: {
            line: 51,
            column: 3
          }
        },
        line: 42
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 53,
            column: 57
          },
          end: {
            line: 53,
            column: 58
          }
        },
        loc: {
          start: {
            line: 53,
            column: 63
          },
          end: {
            line: 59,
            column: 3
          }
        },
        line: 53
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 61,
            column: 47
          },
          end: {
            line: 61,
            column: 48
          }
        },
        loc: {
          start: {
            line: 61,
            column: 53
          },
          end: {
            line: 72,
            column: 3
          }
        },
        line: 61
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 74,
            column: 51
          },
          end: {
            line: 74,
            column: 52
          }
        },
        loc: {
          start: {
            line: 74,
            column: 57
          },
          end: {
            line: 76,
            column: 3
          }
        },
        line: 74
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 78,
            column: 43
          },
          end: {
            line: 78,
            column: 44
          }
        },
        loc: {
          start: {
            line: 78,
            column: 49
          },
          end: {
            line: 82,
            column: 3
          }
        },
        line: 78
      }
    },
    branchMap: {},
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0
    },
    b: {},
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _ProviderRegistry;

function _load_ProviderRegistry() {
  return _ProviderRegistry = _interopRequireDefault(require('../ProviderRegistry'));
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

cov_17zfov6qso.s[0]++;


describe('ProviderRegistry', () => {
  cov_17zfov6qso.f[0]++;

  let providerRegistry = (cov_17zfov6qso.s[1]++, null);
  let provider1;
  let provider2;

  cov_17zfov6qso.s[2]++;
  beforeEach(() => {
    cov_17zfov6qso.f[1]++;
    cov_17zfov6qso.s[3]++;

    providerRegistry = new (_ProviderRegistry || _load_ProviderRegistry()).default();
    cov_17zfov6qso.s[4]++;
    provider1 = {
      priority: 10,
      grammarScopes: ['foo', 'bar']
    };
    cov_17zfov6qso.s[5]++;
    provider2 = {
      priority: 9,
      grammarScopes: ['bar', 'baz']
    };
    cov_17zfov6qso.s[6]++;
    providerRegistry.addProvider(provider1);
    cov_17zfov6qso.s[7]++;
    providerRegistry.addProvider(provider2);
  });

  cov_17zfov6qso.s[8]++;
  it('should return the highest-priority provider', () => {
    cov_17zfov6qso.f[2]++;
    cov_17zfov6qso.s[9]++;

    expect(providerRegistry.findProvider('foo')).toBe(provider1);
    cov_17zfov6qso.s[10]++;
    expect(providerRegistry.findProvider('bar')).toBe(provider1);
    cov_17zfov6qso.s[11]++;
    expect(providerRegistry.findProvider('baz')).toBe(provider2);
  });

  cov_17zfov6qso.s[12]++;
  it('should return the provider for an editor', () => {
    cov_17zfov6qso.f[3]++;

    const editor = (cov_17zfov6qso.s[13]++, {
      getGrammar() {
        cov_17zfov6qso.s[14]++;

        return {
          scopeName: 'foo'
        };
      }
    });
    cov_17zfov6qso.s[15]++;
    expect(providerRegistry.getProviderForEditor(editor)).toBe(provider1);
  });

  cov_17zfov6qso.s[16]++;
  it('should treat null grammarScopes as all-inclusive', () => {
    cov_17zfov6qso.f[4]++;

    const provider3 = (cov_17zfov6qso.s[17]++, {
      priority: 0
    });
    cov_17zfov6qso.s[18]++;
    providerRegistry.addProvider(provider3);
    cov_17zfov6qso.s[19]++;
    expect(providerRegistry.findProvider('asdf')).toBe(provider3);
  });

  cov_17zfov6qso.s[20]++;
  it('can return all providers for an editor', () => {
    cov_17zfov6qso.f[5]++;

    const editor = (cov_17zfov6qso.s[21]++, {
      getGrammar() {
        cov_17zfov6qso.s[22]++;

        return {
          scopeName: 'bar'
        };
      }
    });
    cov_17zfov6qso.s[23]++;
    expect(Array.from(providerRegistry.getAllProvidersForEditor(editor))).toEqual([provider1, provider2]);
  });

  cov_17zfov6qso.s[24]++;
  it('should return null if there is no provider', () => {
    cov_17zfov6qso.f[6]++;
    cov_17zfov6qso.s[25]++;

    expect(providerRegistry.findProvider('42')).toBeNull();
  });

  cov_17zfov6qso.s[26]++;
  it('should correctly remove a provider', () => {
    cov_17zfov6qso.f[7]++;
    cov_17zfov6qso.s[27]++;

    providerRegistry.removeProvider(provider1);
    cov_17zfov6qso.s[28]++;
    expect(providerRegistry.findProvider('foo')).toBe(null);
    cov_17zfov6qso.s[29]++;
    expect(providerRegistry.findProvider('bar')).toBe(provider2);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlByb3ZpZGVyUmVnaXN0cnktc3BlYy5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsInByb3ZpZGVyUmVnaXN0cnkiLCJwcm92aWRlcjEiLCJwcm92aWRlcjIiLCJiZWZvcmVFYWNoIiwicHJpb3JpdHkiLCJncmFtbWFyU2NvcGVzIiwiYWRkUHJvdmlkZXIiLCJpdCIsImV4cGVjdCIsImZpbmRQcm92aWRlciIsInRvQmUiLCJlZGl0b3IiLCJnZXRHcmFtbWFyIiwic2NvcGVOYW1lIiwiZ2V0UHJvdmlkZXJGb3JFZGl0b3IiLCJwcm92aWRlcjMiLCJBcnJheSIsImZyb20iLCJnZXRBbGxQcm92aWRlcnNGb3JFZGl0b3IiLCJ0b0VxdWFsIiwidG9CZU51bGwiLCJyZW1vdmVQcm92aWRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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O0FBS0QsQ0FsRUQiLCJmaWxlIjoiUHJvdmlkZXJSZWdpc3RyeS1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHR5cGUge1Byb3ZpZGVyfSBmcm9tICcuLi9Qcm92aWRlclJlZ2lzdHJ5JztcblxuaW1wb3J0IFByb3ZpZGVyUmVnaXN0cnkgZnJvbSAnLi4vUHJvdmlkZXJSZWdpc3RyeSc7XG5cbmRlc2NyaWJlKCdQcm92aWRlclJlZ2lzdHJ5JywgKCkgPT4ge1xuICBsZXQgcHJvdmlkZXJSZWdpc3RyeTogUHJvdmlkZXJSZWdpc3RyeTxQcm92aWRlcj4gPSAobnVsbDogYW55KTtcbiAgbGV0IHByb3ZpZGVyMTogUHJvdmlkZXI7XG4gIGxldCBwcm92aWRlcjI6IFByb3ZpZGVyO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHByb3ZpZGVyUmVnaXN0cnkgPSBuZXcgUHJvdmlkZXJSZWdpc3RyeSgpO1xuICAgIHByb3ZpZGVyMSA9IHtcbiAgICAgIHByaW9yaXR5OiAxMCxcbiAgICAgIGdyYW1tYXJTY29wZXM6IFsnZm9vJywgJ2JhciddLFxuICAgIH07XG4gICAgcHJvdmlkZXIyID0ge1xuICAgICAgcHJpb3JpdHk6IDksXG4gICAgICBncmFtbWFyU2NvcGVzOiBbJ2JhcicsICdiYXonXSxcbiAgICB9O1xuICAgIHByb3ZpZGVyUmVnaXN0cnkuYWRkUHJvdmlkZXIocHJvdmlkZXIxKTtcbiAgICBwcm92aWRlclJlZ2lzdHJ5LmFkZFByb3ZpZGVyKHByb3ZpZGVyMik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmV0dXJuIHRoZSBoaWdoZXN0LXByaW9yaXR5IHByb3ZpZGVyJywgKCkgPT4ge1xuICAgIGV4cGVjdChwcm92aWRlclJlZ2lzdHJ5LmZpbmRQcm92aWRlcignZm9vJykpLnRvQmUocHJvdmlkZXIxKTtcbiAgICBleHBlY3QocHJvdmlkZXJSZWdpc3RyeS5maW5kUHJvdmlkZXIoJ2JhcicpKS50b0JlKHByb3ZpZGVyMSk7XG4gICAgZXhwZWN0KHByb3ZpZGVyUmVnaXN0cnkuZmluZFByb3ZpZGVyKCdiYXonKSkudG9CZShwcm92aWRlcjIpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJldHVybiB0aGUgcHJvdmlkZXIgZm9yIGFuIGVkaXRvcicsICgpID0+IHtcbiAgICBjb25zdCBlZGl0b3I6IGFueSA9IHtcbiAgICAgIGdldEdyYW1tYXIoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc2NvcGVOYW1lOiAnZm9vJyxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfTtcbiAgICBleHBlY3QocHJvdmlkZXJSZWdpc3RyeS5nZXRQcm92aWRlckZvckVkaXRvcihlZGl0b3IpKS50b0JlKHByb3ZpZGVyMSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgdHJlYXQgbnVsbCBncmFtbWFyU2NvcGVzIGFzIGFsbC1pbmNsdXNpdmUnLCAoKSA9PiB7XG4gICAgY29uc3QgcHJvdmlkZXIzID0ge1xuICAgICAgcHJpb3JpdHk6IDAsXG4gICAgfTtcbiAgICBwcm92aWRlclJlZ2lzdHJ5LmFkZFByb3ZpZGVyKHByb3ZpZGVyMyk7XG4gICAgZXhwZWN0KHByb3ZpZGVyUmVnaXN0cnkuZmluZFByb3ZpZGVyKCdhc2RmJykpLnRvQmUocHJvdmlkZXIzKTtcbiAgfSk7XG5cbiAgaXQoJ2NhbiByZXR1cm4gYWxsIHByb3ZpZGVycyBmb3IgYW4gZWRpdG9yJywgKCkgPT4ge1xuICAgIGNvbnN0IGVkaXRvcjogYW55ID0ge1xuICAgICAgZ2V0R3JhbW1hcigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzY29wZU5hbWU6ICdiYXInLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9O1xuICAgIGV4cGVjdChcbiAgICAgIEFycmF5LmZyb20ocHJvdmlkZXJSZWdpc3RyeS5nZXRBbGxQcm92aWRlcnNGb3JFZGl0b3IoZWRpdG9yKSksXG4gICAgKS50b0VxdWFsKFtwcm92aWRlcjEsIHByb3ZpZGVyMl0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJldHVybiBudWxsIGlmIHRoZXJlIGlzIG5vIHByb3ZpZGVyJywgKCkgPT4ge1xuICAgIGV4cGVjdChwcm92aWRlclJlZ2lzdHJ5LmZpbmRQcm92aWRlcignNDInKSkudG9CZU51bGwoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBjb3JyZWN0bHkgcmVtb3ZlIGEgcHJvdmlkZXInLCAoKSA9PiB7XG4gICAgcHJvdmlkZXJSZWdpc3RyeS5yZW1vdmVQcm92aWRlcihwcm92aWRlcjEpO1xuICAgIGV4cGVjdChwcm92aWRlclJlZ2lzdHJ5LmZpbmRQcm92aWRlcignZm9vJykpLnRvQmUobnVsbCk7XG4gICAgZXhwZWN0KHByb3ZpZGVyUmVnaXN0cnkuZmluZFByb3ZpZGVyKCdiYXInKSkudG9CZShwcm92aWRlcjIpO1xuICB9KTtcbn0pO1xuIl19